"use strict";(this.webpackChunk=this.webpackChunk||[]).push([[7427],{6677:(t,s,n)=>{n.d(s,{re:()=>b,kh:()=>y,cd:()=>g,A_:()=>f});var a=n(5524),e=n(385),i=n(4886);var c=n(1370),r=n(1162),o=n(4285),u=n(7031),l=n(6633),p=n(4358);async function h(t,s){const{loggedInInstances:n}=a.h.get(),c=n[t].access_token;await s((()=>function(t,s){const n=`${(0,i.E)(t)}/api/v1/filters`;return(0,e.U2)(n,(0,i.I)(s),{timeout:e.EH})}(t,c)),(()=>r.F.getFilters(t)),(s=>r.F.setFilters(t,s)),(s=>{const{instanceFilters:n}=a.h.get();(0,o.Xy)(n[t],s)||(n[t]=s,a.h.set({instanceFilters:n}))}))}async function f(t){await h(t,c.u)}async function g(t){await h(t,c.o)}async function b(t,s){const{loggedInInstances:n}=a.h.get(),c=n[t].access_token;try{s.id?(await function(t,s,n){const a=`${(0,i.E)(t)}/api/v1/filters/${n.id}`;return(0,e.gz)(a,n,(0,i.I)(s),{timeout:e.$Q})}(t,c,s),u.A.say("Updated filter")):(await function(t,s,n){const a=`${(0,i.E)(t)}/api/v1/filters`;return(0,e.v_)(a,n,(0,i.I)(s),{timeout:e.$Q})}(t,c,s),u.A.say("Created filter")),(0,p.j)("wordFiltersChanged",t)}catch(r){u.A.say((0,l.A)(["Failed to modify filter: ",["error"]],r.message||""))}}async function y(t,s){const{loggedInInstances:n}=a.h.get(),c=n[t].access_token;try{await function(t,s,n){const a=`${(0,i.E)(t)}/api/v1/filters/${n}`;return(0,e.IV)(a,(0,i.I)(s),{timeout:e.$Q})}(t,c,s),u.A.say("Deleted filter"),(0,p.j)("wordFiltersChanged",t)}catch(r){u.A.say((0,l.A)(["Failed to modify filter: ",["error"]],r.message||""))}}},5060:(t,s,n)=>{n.d(s,{u:()=>l,Z:()=>u});var a=n(4886),e=n(385);async function i(t,s,n,i){const c=`${(0,a.E)(t)}/api/v1/push/subscription`;return(0,e.v_)(c,{subscription:n.toJSON(),data:{alerts:i}},(0,a.I)(s))}var c=n(5524);const r=t=>(t=>{const s=window.atob(t),n=new Uint8Array(s.length);for(let a=0;a<s.length;++a)n[a]=s.charCodeAt(a);return n})((t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/")),o="BImgAz4cF_yvNFp8uoBJCaGpCX4d0atNIFMHfBvAAXCyrnn9IMAFQ10DW_ZvBCzGeR4fZI5FnEi2JVcRE-L88jY=";async function u(t){const{loggedInInstances:s,currentPushSubscription:n}=c.h.get(),i=s[t].access_token;if(null===n)return;const o=await navigator.serviceWorker.ready,u=await o.pushManager.getSubscription();if(null===u)return c.h.setInstanceData(t,"pushSubscriptions",null),void c.h.save();try{const s=await async function(t,s){const n=`${(0,a.E)(t)}/api/v1/push/subscription`;return(0,e.U2)(n,(0,a.I)(s))}(t,i);btoa(r(s.server_key).buffer)!==btoa(u.options.applicationServerKey)?(await u.unsubscribe(),await async function(t,s){const n=`${(0,a.E)(t)}/api/v1/push/subscription`;return(0,e.IV)(n,(0,a.I)(s))}(t,i),await l(t,n.alerts)):(c.h.setInstanceData(t,"pushSubscriptions",s),c.h.save())}catch(p){p.message.startsWith("404:")&&(await u.unsubscribe(),c.h.setInstanceData(t,"pushSubscriptions",null),c.h.save())}}async function l(t,s){const{loggedInInstances:n}=c.h.get(),u=n[t].access_token,l=await navigator.serviceWorker.ready;let p=await l.pushManager.getSubscription();if(null===p){p=await l.pushManager.subscribe({applicationServerKey:r(o),userVisibleOnly:!0});let n=await i(t,u,p,s);await p.unsubscribe(),p=await l.pushManager.subscribe({applicationServerKey:r(n.server_key),userVisibleOnly:!0}),n=await i(t,u,p,s),c.h.setInstanceData(t,"pushSubscriptions",n),c.h.save()}else try{const n=await async function(t,s,n){const i=`${(0,a.E)(t)}/api/v1/push/subscription`;return(0,e.gz)(i,{data:{alerts:n}},(0,a.I)(s))}(t,u,s);c.h.setInstanceData(t,"pushSubscriptions",n),c.h.save()}catch(h){const n=await i(t,u,p,s);c.h.setInstanceData(t,"pushSubscriptions",n),c.h.save()}}},5061:(t,s,n)=>{n.d(s,{AL:()=>c,B$:()=>e,M9:()=>o,Z3:()=>a,cT:()=>i,dS:()=>r,rs:()=>u,sr:()=>l});const a="homeReblogs",e="homeReplies",i="notificationReblogs",c="notificationFavs",r="notificationFollows",o="notificationMentions",u="notificationPolls",l="notificationSubscriptions"}}]);
//# sourceMappingURL=7427.ad2347c099f28a75446d.7427.js.map