"use strict";(this.webpackChunk=this.webpackChunk||[]).push([[7666],{7666:(t,e,r)=>{r.r(e),r.d(e,{default:()=>L});var a=r(4178),s=r(5291),o=r(5984),n=r(9065),i=r(2771),l=r(6288),c=r(5524),d=r(9076);var p=r(9006),u=r(7031),h=r(4886),f=r(385);var m=r(6633);async function v(t,e,r,a){const{currentInstance:s,accessToken:o}=c.h.get();try{await async function(t,e,r,a,s,o){const n=`${(0,h.E)(t)}/api/v1/reports`;return(0,f.v_)(n,{account_id:r,status_ids:a,comment:s,forward:o},(0,h.I)(e))}(s,o,t.id,e,r,a),u.A.say("Submitted report")}catch(n){u.A.say((0,m.A)(["Failed to report: ",["error"]],{error:n.message||""}))}}var y={show:n.$,close:i.x,onChange(t,e){const r=e.target.checked,{reportMap:a}=this.get();a[t]=r},async doReport(){const{displayStatuses:t,account:e,comment:r,forward:a,reportMap:s}=this.get(),o=t.map((({id:t})=>t)).filter((t=>s[t]));o.length?await v(e,o,r,a):u.A.say("No posts to report")}};async function w(){l.U.call(this);const{account:t,status:e,reportMap:r}=this.get();e&&(r[e.id]=!0);try{const e=await async function(t){const{currentInstance:e,accessToken:r}=c.h.get();return(await(0,d.V)(e,r,`account/${t}`,null,null,20)).items}(t.id);this.set({recentStatuses:e})}catch(a){console.error(a),u.A.say((0,m.A)(["Unable to load recent posts: ",["error"]],{error:a.message||""}))}finally{this.set({loading:!1})}}function g(t){const{component:e,ctx:r}=this._svelte;e.onChange(r.status.id,t)}function x(t,e,r){const a=Object.create(t);return a.status=e[r],a}function b(t,e){var r,s=[],o=(0,a.L7)(),n=e.displayStatuses;const i=t=>t.status.id;for(var l=0;l<n.length;l+=1){let r=x(e,n,l),a=i(r);s[l]=o[a]=q(t,a,r)}return{c(){for(r=(0,a.az)("ul"),l=0;l<s.length;l+=1)s[l].c();this.h()},l(t){r=(0,a.d$)(t,"UL",{class:!0},!1);var e=(0,a.pI)(r);for(l=0;l<s.length;l+=1)s[l].l(e);e.forEach(a.r2),this.h()},h(){r.className="svelte-1jqy48r"},m(t,e){for((0,a.$T)(t,r,e),l=0;l<s.length;l+=1)s[l].m(r,null)},p(e,n){const l=n.displayStatuses;s=(0,a.$q)(s,t,e,i,1,n,l,o,r,a.pp,q,"m",null,x)},d(t){for(t&&(0,a.r2)(r),l=0;l<s.length;l+=1)s[l].d()}}}function j(t,e){var r,s=new o.Z({root:t.root,store:t.store});return{c(){r=(0,a.az)("div"),s._fragment.c(),this.h()},l(t){r=(0,a.d$)(t,"DIV",{class:!0},!1);var e=(0,a.pI)(r);s._fragment.l(e),e.forEach(a.r2),this.h()},h(){r.className="loading-spinner-container svelte-1jqy48r"},m(t,e){(0,a.$T)(t,r,e),s._mount(r,null)},p:a.ZT,d(t){t&&(0,a.r2)(r),s.destroy()}}}function q(t,e,r){var s,o,n,i,l,c,d,p,u,h=r.status.text;return{key:e,first:null,c(){s=(0,a.az)("li"),o=(0,a.az)("input"),c=(0,a.rw)("\n                "),d=(0,a.az)("label"),p=(0,a.rw)(h),this.h()},l(t){s=(0,a.d$)(t,"LI",{class:!0},!1);var e=(0,a.pI)(s);o=(0,a.d$)(e,"INPUT",{type:!0,id:!0,name:!0,checked:!0,class:!0},!1),(0,a.pI)(o).forEach(a.r2),c=(0,a.M4)(e,"\n                "),d=(0,a.d$)(e,"LABEL",{for:!0,class:!0},!1);var r=(0,a.pI)(d);p=(0,a.M4)(r,h),r.forEach(a.r2),e.forEach(a.r2),this.h()},h(){o._svelte={component:t,ctx:r},(0,a.NH)(o,"change",g),(0,a.P$)(o,"type","checkbox"),o.id=n="status-report-"+r.status.id,o.name=i="status-report-"+r.status.id,o.checked=l=r.status.report,o.className="svelte-1jqy48r",d.htmlFor=u="status-report-"+r.status.id,d.className="svelte-1jqy48r",s.className="svelte-1jqy48r",this.first=s},m(t,e){(0,a.$T)(t,s,e),(0,a.R3)(s,o),(0,a.R3)(s,c),(0,a.R3)(s,d),(0,a.R3)(d,p)},p(t,e){r=e,o._svelte.ctx=r,t.displayStatuses&&n!==(n="status-report-"+r.status.id)&&(o.id=n),t.displayStatuses&&i!==(i="status-report-"+r.status.id)&&(o.name=i),t.displayStatuses&&l!==(l=r.status.report)&&(o.checked=l),t.displayStatuses&&h!==(h=r.status.text)&&(0,a.a_)(p,h),t.displayStatuses&&u!==(u="status-report-"+r.status.id)&&(d.htmlFor=u)},d(t){t&&(0,a.r2)(s),(0,a.ys)(o,"change",g)}}}function I(t,e){var r,s,o,n,i,l,c;function d(){t.set({forward:n.checked})}return{c(){r=(0,a.az)("p"),s=(0,a.rw)(e.forwardDescription),o=(0,a.rw)("\n          "),n=(0,a.az)("input"),i=(0,a.rw)("\n          "),l=(0,a.az)("label"),c=(0,a.rw)(e.forwardLabel),this.h()},l(t){r=(0,a.d$)(t,"P",{class:!0},!1);var d=(0,a.pI)(r);s=(0,a.M4)(d,e.forwardDescription),d.forEach(a.r2),o=(0,a.M4)(t,"\n          "),n=(0,a.d$)(t,"INPUT",{type:!0,id:!0,name:!0},!1),(0,a.pI)(n).forEach(a.r2),i=(0,a.M4)(t,"\n          "),l=(0,a.d$)(t,"LABEL",{for:!0,class:!0},!1);var p=(0,a.pI)(l);c=(0,a.M4)(p,e.forwardLabel),p.forEach(a.r2),this.h()},h(){r.className="svelte-1jqy48r",(0,a.NH)(n,"change",d),(0,a.P$)(n,"type","checkbox"),n.id="report-forward",n.name="report-forward",l.htmlFor="report-forward",l.className="svelte-1jqy48r"},m(t,d){(0,a.$T)(t,r,d),(0,a.R3)(r,s),(0,a.$T)(t,o,d),(0,a.$T)(t,n,d),n.checked=e.forward,(0,a.$T)(t,i,d),(0,a.$T)(t,l,d),(0,a.R3)(l,c)},p(t,e){t.forwardDescription&&(0,a.a_)(s,e.forwardDescription),t.forward&&(n.checked=e.forward),t.forwardLabel&&(0,a.a_)(c,e.forwardLabel)},d(t){t&&((0,a.r2)(r),(0,a.r2)(o),(0,a.r2)(n)),(0,a.ys)(n,"change",d),t&&((0,a.r2)(i),(0,a.r2)(l))}}}function _(t){var e;if((0,a.S1)(this,t),this.store=c.h,this._state=(0,a.f0)((0,a.f0)(this.store._init(["currentInstance"]),{account:void 0,status:void 0,positiveText:"Report",reportMap:{},recentStatuses:[],loading:!0,forward:!1,comment:""}),t.data),this.store._add(this,["currentInstance"]),this._recompute({status:1,recentStatuses:1,statuses:1,reportMap:1,account:1,$currentInstance:1,remoteInstance:1},this._state),this._intro=!0,this._handlers.destroy=[a.iT],document.getElementById("svelte-1jqy48r-style")||((e=(0,a.az)("style")).id="svelte-1jqy48r-style",e.textContent=".report-dialog-contents .confirmation-dialog-form{max-width:80vw}.report-dialog.svelte-1jqy48r{padding:20px 40px;overflow-y:auto}.loading-spinner-container.svelte-1jqy48r{width:100%;height:100%;display:flex;justify-content:center;align-items:center}ul.svelte-1jqy48r{list-style:none;max-height:30vh;overflow-y:auto;overflow-x:hidden;border:1px solid var(--main-border)}li.svelte-1jqy48r{padding:10px 5px;border-top:1px solid var(--main-border)}li.svelte-1jqy48r:first-child{border-top:none}.recent-statuses.svelte-1jqy48r label.svelte-1jqy48r{padding:10px 5px;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical}textarea.svelte-1jqy48r{width:100%;overflow-y:auto;max-height:40vh;font-size:1.3em;min-height:100px}p.svelte-1jqy48r{margin:20px 0}.recent-statuses.svelte-1jqy48r li.svelte-1jqy48r{display:flex;flex-direction:row;align-items:center}.recent-statuses.svelte-1jqy48r input.svelte-1jqy48r{margin-right:10px}.recent-statuses.svelte-1jqy48r label.svelte-1jqy48r{width:0;flex:1;word-wrap:break-word;overflow:hidden;white-space:pre-wrap;text-overflow:ellipsis;border-left:1px solid var(--main-border);padding-left:10px}.report-flex.svelte-1jqy48r{display:flex;flex-direction:row}.report-flex.svelte-1jqy48r>.svelte-1jqy48r{flex:1}.report-info.svelte-1jqy48r{margin-left:20px}@media(max-width: 767px){.report-dialog.svelte-1jqy48r{padding:20px;overflow-x:hidden;max-height:65vh}.report-flex.svelte-1jqy48r{flex-direction:column}.report-info.svelte-1jqy48r{margin-left:0}textarea.svelte-1jqy48r{max-height:20vh}p.svelte-1jqy48r,label.svelte-1jqy48r{word-wrap:break-word}.report-dialog-contents .confirmation-dialog-form{max-width:calc(100% - 20px)}}",(0,a.R3)(document.head,e)),this._fragment=function(t,e){var r,o,n,i,l,c,d,p,u,h,f,m,v,y=!1;function w(t){return t.loading?j:b}var g=w(e),x=g(t,e);function q(){y=!0,t.set({comment:m.value}),y=!1}var _=e.remoteInstance&&I(t,e),$={id:e.id,label:e.label,title:e.title,className:"report-dialog-contents",positiveText:e.positiveText},R=new s.Z({root:t.root,store:t.store,slots:{default:(0,a.xJ)()},data:$});return R.on("positive",(function(e){t.doReport()})),{c(){r=(0,a.az)("div"),o=(0,a.az)("div"),n=(0,a.az)("div"),x.c(),i=(0,a.rw)("\n      "),l=(0,a.az)("div"),c=(0,a.az)("p"),d=(0,a.rw)(e.reportingLabel),p=(0,a.rw)("\n        "),u=(0,a.az)("label"),h=(0,a.rw)("Additional comments"),f=(0,a.rw)("\n        "),m=(0,a.az)("textarea"),v=(0,a.rw)("\n        "),_&&_.c(),R._fragment.c(),this.h()},l(t){r=(0,a.d$)(t,"DIV",{class:!0},!1);var s=(0,a.pI)(r);o=(0,a.d$)(s,"DIV",{class:!0},!1);var y=(0,a.pI)(o);n=(0,a.d$)(y,"DIV",{class:!0},!1);var w=(0,a.pI)(n);x.l(w),w.forEach(a.r2),i=(0,a.M4)(y,"\n      "),l=(0,a.d$)(y,"DIV",{class:!0},!1);var g=(0,a.pI)(l);c=(0,a.d$)(g,"P",{class:!0},!1);var b=(0,a.pI)(c);d=(0,a.M4)(b,e.reportingLabel),b.forEach(a.r2),p=(0,a.M4)(g,"\n        "),u=(0,a.d$)(g,"LABEL",{class:!0,id:!0},!1);var j=(0,a.pI)(u);h=(0,a.M4)(j,"Additional comments"),j.forEach(a.r2),f=(0,a.M4)(g,"\n        "),m=(0,a.d$)(g,"TEXTAREA",{placeholder:!0,"aria-labelledby":!0,maxlength:!0,class:!0},!1),(0,a.pI)(m).forEach(a.r2),v=(0,a.M4)(g,"\n        "),_&&_.l(g),g.forEach(a.r2),y.forEach(a.r2),s.forEach(a.r2),R._fragment.l(t),this.h()},h(){n.className="recent-statuses svelte-1jqy48r",c.className="svelte-1jqy48r",u.className="sr-only svelte-1jqy48r",u.id="comments-label",(0,a.NH)(m,"input",q),m.placeholder="Additional comments",(0,a.P$)(m,"aria-labelledby","comments-label"),m.maxLength="1000",m.className="svelte-1jqy48r",l.className="report-info svelte-1jqy48r",o.className="report-flex svelte-1jqy48r",r.className="report-dialog svelte-1jqy48r"},m(t,s){(0,a.R3)(R._slotted.default,r),(0,a.R3)(r,o),(0,a.R3)(o,n),x.m(n,null),(0,a.R3)(o,i),(0,a.R3)(o,l),(0,a.R3)(l,c),(0,a.R3)(c,d),(0,a.R3)(l,p),(0,a.R3)(l,u),(0,a.R3)(u,h),(0,a.R3)(l,f),(0,a.R3)(l,m),m.value=e.comment,(0,a.R3)(l,v),_&&_.m(l,null),R._mount(t,s)},p(e,r){g===(g=w(r))&&x?x.p(e,r):(x.d(1),(x=g(t,r)).c(),x.m(n,null)),e.reportingLabel&&(0,a.a_)(d,r.reportingLabel),!y&&e.comment&&(m.value=r.comment),r.remoteInstance?_?_.p(e,r):((_=I(t,r)).c(),_.m(l,null)):_&&(_.d(1),_=null);var s={};e.id&&(s.id=r.id),e.label&&(s.label=r.label),e.title&&(s.title=r.title),e.positiveText&&(s.positiveText=r.positiveText),R._set(s)},d(t){x.d(),(0,a.ys)(m,"input",q),_&&_.d(),R.destroy(t)}}}(this,this._state),this.root._oncreate.push((()=>{w.call(this),this.fire("update",{changed:(0,a.lZ)({},this._state),current:this._state})})),t.target){var r=(0,a.pI)(t.target);t.hydrate?this._fragment.l(r):this._fragment.c(),r.forEach(a.r2),this._mount(t.target,t.anchor),(0,a.yl)(this)}}(0,a.f0)(_.prototype,a.uS),(0,a.f0)(_.prototype,y),_.prototype._recompute=function(t,e){(t.status||t.recentStatuses)&&this._differs(e.statuses,e.statuses=function({status:t,recentStatuses:e}){return[t].concat((e||[]).filter((({id:e})=>!t||e!==t.id))).filter(Boolean)}(e))&&(t.statuses=!0),(t.statuses||t.reportMap)&&this._differs(e.displayStatuses,e.displayStatuses=function({statuses:t,reportMap:e}){return t.map((t=>({id:t.id,text:(0,p.g)(t.content,t.mentions)||"(No content)",report:e[t.id]})))}(e))&&(t.displayStatuses=!0),t.account&&this._differs(e.remoteInstance,e.remoteInstance=function({account:t}){return t.acct.split("@")[1]}(e))&&(t.remoteInstance=!0),(t.account||t.$currentInstance)&&this._differs(e.reportingLabel,e.reportingLabel=function({account:t,$currentInstance:e}){return(0,m.A)(["You are reporting ",["account"]," to the moderators of ",["instance"],"."],{account:`@${t.acct}`,instance:e})}(e))&&(t.reportingLabel=!0),t.remoteInstance&&(this._differs(e.forwardDescription,e.forwardDescription=function({remoteInstance:t}){return(0,m.A)(["Forward to the moderators of ",["instance"]," as well?"],{instance:t})}(e))&&(t.forwardDescription=!0),this._differs(e.forwardLabel,e.forwardLabel=function({remoteInstance:t}){return(0,m.A)(["Forward to ",["instance"]],{instance:t})}(e))&&(t.forwardLabel=!0))};const $=_;var R=r(3634);function L({account:t,status:e}){const r=(0,m.A)(["Report ",["account"]],{account:`@${t.acct}`});return(0,R.v)($,{label:r,title:r,account:t,status:e})}}}]);
//# sourceMappingURL=7666.aa1518a5f0afce249713.7666.js.map