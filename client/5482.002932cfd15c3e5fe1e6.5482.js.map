{"version":3,"file":"5482.002932cfd15c3e5fe1e6.5482.js","mappings":"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","sources":["webpack:///./src/routes/_components/LengthGauge.html","webpack:///./src/routes/_components/LengthIndicator.html","webpack:///./src/routes/_components/compose/ComposeLengthIndicator.html","webpack:///./src/routes/_components/compose/ComposeToolbar.html","webpack:///./src/routes/_components/dialog/asyncDialogs/importShowPostPrivacyDialog.js","webpack:///./src/routes/_components/dialog/asyncDialogs/importShowContentTypeDialog.js","webpack:///./src/routes/_actions/contentWarnings.js","webpack:///./src/routes/_actions/composePoll.js","webpack:///./src/routes/_components/compose/ComposeLengthGauge.html","webpack:///./src/routes/_components/compose/ComposeAuthor.html","webpack:///./src/routes/_actions/autosuggest.js","webpack:///./src/routes/_utils/userAgent/isWebKit.js","webpack:///./src/routes/_components/compose/ComposeInput.html","webpack:///./src/routes/_components/compose/ComposeButton.html","webpack:///./src/routes/_components/compose/ComposeStickyButton.html","webpack:///./src/routes/_components/dialog/asyncDialogs/importShowMediaEditDialog.js","webpack:///./src/routes/_components/compose/ComposeMediaItem.html","webpack:///./src/routes/_components/compose/ComposeMedia.html","webpack:///./src/routes/_components/compose/ComposeContentWarning.html","webpack:///./src/routes/_components/compose/ComposeFileDrop.html","webpack:///./src/routes/_components/compose/ComposeAutosuggestionList.html","webpack:///./src/routes/_utils/createAutosuggestAccessibleLabel.js","webpack:///./src/routes/_components/compose/ComposeAutosuggestContainer.html","webpack:///./src/routes/_utils/once.js","webpack:///./src/routes/_components/compose/ComposeAutosuggest.html","webpack:///./src/routes/_static/polls.js","webpack:///./src/routes/_components/compose/ComposePoll.html","webpack:///./src/routes/_components/compose/ComposeMediaSensitive.html","webpack:///./src/routes/_transitions/slide.js","webpack:///./src/routes/_actions/compose.js","webpack:///./src/routes/_components/compose/ComposeBox.html","webpack:///./src/routes/_workers/blurhash.js","webpack:///./src/routes/_static/blurhash.js","webpack:///./src/routes/_utils/blurhash.js","webpack:///./src/routes/_utils/hashtagBar.js","webpack:///./src/routes/_actions/rehydrateStatusOrNotification.js","webpack:///./src/routes/_api/statuses.js","webpack:///./src/routes/_components/dialog/asyncDialogs/importShowEmojiDialog.js","webpack:///./src/routes/_thirdparty/autosize/autosize.js","webpack:///./src/routes/_utils/urlRegex.js","webpack:///./src/routes/_utils/handleRegex.js","webpack:///./src/routes/_utils/measureText.js","webpack:///./src/routes/_utils/requestPostAnimationFrame.js","webpack:///./src/routes/_utils/statusHtmlToPlainText.js","webpack:///./src/routes/_utils/throttleTimer.js"],"sourcesContent":["<div class={computedClass}\n     style={style}\n     aria-hidden=\"true\"\n><div class=\"length-gauge-inner\" style={computedStyle}></div></div>\n<style>\n  .length-gauge {\n    height: 2px;\n  }\n  .length-gauge-inner {\n    transform-origin: left;\n    background: var(--main-theme-color);\n    height: 100%;\n  }\n  .length-gauge.should-animate .length-gauge-inner {\n    transition: transform 0.2s linear;\n  }\n  .length-gauge.over-char-limit .length-gauge-inner {\n    background: var(--warning-color);\n  }\n</style>\n<script>\n  import { mark, stop } from '../_utils/marks.js'\n  import { store } from '../_store/store.js'\n  import { observe } from 'svelte-extras'\n  import { throttleTimer } from '../_utils/throttleTimer.js'\n  import { classname } from '../_utils/classname.js'\n\n  const updateDisplayedLength = process.browser && throttleTimer(requestAnimationFrame)\n\n  export default {\n    oncreate () {\n      const { lengthAsFraction } = this.get()\n      this.set({ lengthAsFractionDeferred: lengthAsFraction })\n      // perf improvement for keyboard input latency\n      this.observe('lengthAsFraction', () => {\n        updateDisplayedLength(() => {\n          mark('set lengthAsFractionDeferred')\n          const { lengthAsFraction } = this.get()\n          this.set({ lengthAsFractionDeferred: lengthAsFraction })\n          stop('set lengthAsFractionDeferred')\n          requestAnimationFrame(() => this.set({ shouldAnimate: true }))\n        })\n      }, { init: false })\n    },\n    data: () => ({\n      shouldAnimate: false,\n      lengthAsFractionDeferred: 0,\n      style: ''\n    }),\n    store: () => store,\n    computed: {\n      lengthAsFraction: ({ length, max }) => {\n        // We don't need to update the gauge for every decimal point, so round it to the nearest 0.02\n        const int = Math.round(Math.min(max, length) / max * 100)\n        return (int - (int % 2)) / 100\n      },\n      computedClass: ({ shouldAnimate, overLimit, $reduceMotion }) => classname(\n        'length-gauge',\n        !$reduceMotion && shouldAnimate && 'should-animate',\n        overLimit && 'over-char-limit'\n      ),\n      computedStyle: ({ style, lengthAsFractionDeferred }) => `transform: scaleX(${lengthAsFractionDeferred})`\n    },\n    methods: {\n      observe\n    }\n  }\n</script>\n","<span class=\"length-indicator {overLimit ? 'over-char-limit' : ''}\"\n      aria-live={lengthVerbosity}\n      aria-atomic='true'\n      {style}\n>{lengthToDisplayDeferred}</span>\n<style>\n  .length-indicator {\n    color: var(--length-indicator-color);\n    font-size: 1.3em;\n  }\n\n  .length-indicator.over-char-limit {\n    color: var(--warning-color);\n  }\n</style>\n<script>\n  import { mark, stop } from '../_utils/marks.js'\n  import { store } from '../_store/store.js'\n  import { observe } from 'svelte-extras'\n  import { throttleTimer } from '../_utils/throttleTimer.js'\n  const updateDisplayedLength = process.browser && throttleTimer(requestAnimationFrame)\n\n  // How many chars within the limit to start warning at\n  const WARN_THRESHOLD = 10\n\n  export default {\n    oncreate () {\n      const { lengthToDisplay } = this.get()\n      this.set({ lengthToDisplayDeferred: lengthToDisplay })\n      // perf improvement for keyboard input latency\n      this.observe('lengthToDisplay', () => {\n        updateDisplayedLength(() => {\n          mark('set lengthToDisplayDeferred')\n          const { lengthToDisplay } = this.get()\n          this.set({ lengthToDisplayDeferred: lengthToDisplay })\n          stop('set lengthToDisplayDeferred')\n        })\n      }, { init: false })\n    },\n    data: () => ({\n      lengthToDisplayDeferred: 0,\n      style: ''\n    }),\n    store: () => store,\n    computed: {\n      lengthToDisplay: ({ length, max }) => max - length,\n      lengthVerbosity: ({ lengthToDisplayDeferred }) => {\n        // When approaching the limit, notify screen reader users\n        if (lengthToDisplayDeferred > WARN_THRESHOLD) {\n          return 'off'\n        } else {\n          return 'polite'\n        }\n      }\n    },\n    methods: {\n      observe\n    }\n  }\n</script>\n","<LengthIndicator\n  {length}\n  {overLimit}\n  max={$maxStatusChars}\n  style=\"flex-grow:1;text-align:right\"\n/>\n<script>\n  import { store } from '../../_store/store.js'\n  import LengthIndicator from '../LengthIndicator.html'\n\n  export default {\n    store: () => store,\n    components: {\n      LengthIndicator\n    }\n  }\n</script>\n","<div class=\"compose-box-toolbar\">\n  <div class=\"compose-box-toolbar-items\">\n    <IconButton\n      className=\"compose-toolbar-button\"\n      label=\"Insert emoji\"\n      href=\"#fa-smile\"\n      on:click=\"onEmojiClick()\"\n    />\n    <IconButton\n      className=\"compose-toolbar-button\"\n      svgClassName={$uploadingMedia ? 'spin' : ''}\n      label=\"Add media (images, video, audio)\"\n      href={$uploadingMedia ? '#fa-spinner' : '#fa-camera'}\n      on:click=\"onMediaClick()\"\n      disabled={$uploadingMedia || (media.length === $maxStatusMediaAttachments)}\n    />\n    <IconButton\n      className=\"compose-toolbar-button\"\n      label=\"Add poll\"\n      pressedLabel=\"Remove poll\"\n      href=\"#fa-bar-chart\"\n      on:click=\"onPollClick()\"\n      pressable={true}\n      pressed={poll && poll.options && poll.options.length}\n    />\n    <IconButton\n      className=\"compose-toolbar-button\"\n      label={postPrivacyLabel}\n      href={actualPostPrivacy.icon}\n      on:click=\"onPostPrivacyClick()\"\n      disabled={!!editId}\n    />\n    <IconButton\n      className=\"compose-toolbar-button\"\n      label=\"Content Type\"\n      href={contentTypeIcon}\n      on:click=\"onContentTypeClick()\"\n    />\n    <IconButton\n      className=\"compose-toolbar-button\"\n      label=\"Add content warning\"\n      pressedLabel=\"Remove content warning\"\n      href=\"#fa-exclamation-triangle\"\n      on:click=\"onContentWarningClick()\"\n      pressable={true}\n      pressed={contentWarningShown}\n    />\n    <ComposeLengthIndicator {length} {overLimit} />\n  </div>\n  <input ref:input\n         on:change=\"onFileChange(event)\"\n         style=\"display: none;\"\n         type=\"file\"\n         multiple\n         accept={mediaAccept} >\n</div>\n<style>\n  .compose-box-toolbar {\n    grid-area: toolbar;\n    align-self: center;\n  }\n  .compose-box-toolbar-items {\n    display: flex;\n    align-items: center;\n    flex-wrap: wrap;\n  }\n\n  @media (max-width: 340px) {\n    :global(button.icon-button.compose-toolbar-button) {\n      padding-left: 5px;\n      padding-right: 5px;\n    }\n  }\n  @media (max-width: 240px) {\n    :global(button.icon-button.compose-toolbar-button .icon-button-svg) {\n      width: 20px;\n      height: 20px;\n    }\n  }\n</style>\n<script>\n  import IconButton from '../IconButton.html'\n  import { store } from '../../_store/store.js'\n  import { importShowEmojiDialog } from '../dialog/asyncDialogs/importShowEmojiDialog.js'\n  import { importShowPostPrivacyDialog } from '../dialog/asyncDialogs/importShowPostPrivacyDialog.js'\n  import { importShowContentTypeDialog } from '../dialog/asyncDialogs/importShowContentTypeDialog.js'\n  import { doMediaUpload } from '../../_actions/media.js'\n  import { toggleContentWarningShown } from '../../_actions/contentWarnings.js'\n  import { mediaAccept } from '../../_static/media.js'\n  import { KNOWN_CONTENT_TYPES } from '../../_static/statuses.js'\n  import { enablePoll, disablePoll } from '../../_actions/composePoll.js'\n  import { updateCustomEmojiForInstance } from '../../_actions/emoji.js'\n  import { formatIntl } from '../../_utils/formatIntl.js'\n  import ComposeLengthIndicator from './ComposeLengthIndicator.html'\n\n  export default {\n    components: {\n      IconButton,\n      ComposeLengthIndicator\n    },\n    data: () => ({\n      mediaAccept\n    }),\n    computed: {\n      actualPostPrivacy: ({ postPrivacy, localOnly }) => ({\n        icon: postPrivacy.icon + (localOnly ? '-home' : ''),\n        label: postPrivacy.label + (localOnly ? ', ' + \"Local only\" : '')\n      }),\n      postPrivacyLabel: ({ actualPostPrivacy, editId }) => editId\n        ? actualPostPrivacy.label\n        : (\n            formatIntl([\"Adjust privacy (currently \",[\"label\"],\")\"], { label: actualPostPrivacy.label })\n          ),\n      contentTypeIcon: ({ contentType }) => (KNOWN_CONTENT_TYPES[contentType] || KNOWN_CONTENT_TYPES.default).icon\n    },\n    store: () => store,\n    methods: {\n      async onEmojiClick () {\n        const { realm } = this.get()\n        const { currentInstance } = this.store.get()\n        const [showEmojiDialog] = await Promise.all([\n          importShowEmojiDialog(),\n          updateCustomEmojiForInstance(currentInstance)\n        ])\n        showEmojiDialog(realm)\n      },\n      onMediaClick () {\n        this.refs.input.click()\n      },\n      async onFileChange (e) {\n        const { files } = e.target\n        const { realm } = this.get()\n        for (const file of files) {\n          await doMediaUpload(realm, file)\n        }\n      },\n      async onPostPrivacyClick () {\n        const { realm } = this.get()\n        const showPostPrivacyDialog = await importShowPostPrivacyDialog()\n        showPostPrivacyDialog(realm)\n      },\n      async onContentTypeClick () {\n        const { realm } = this.get()\n        const showContentTypeDialog = await importShowContentTypeDialog()\n        showContentTypeDialog(realm)\n      },\n      onContentWarningClick () {\n        const { realm } = this.get()\n        toggleContentWarningShown(realm)\n      },\n      onPollClick () {\n        const { poll, realm } = this.get()\n        if (poll && poll.options && poll.options.length) {\n          disablePoll(realm)\n        } else {\n          enablePoll(realm)\n        }\n      }\n    }\n  }\n</script>\n","export const importShowPostPrivacyDialog = () => import(\n  '../creators/showPostPrivacyDialog.js'\n).then(mod => mod.default)\n","export const importShowContentTypeDialog = () => import(\r\n  '../creators/showContentTypeDialog.js'\r\n).then(mod => mod.default)\r\n","import { store } from '../_store/store.js'\n\nexport function toggleContentWarningShown (realm) {\n  const shown = store.getComposeData(realm, 'contentWarningShown')\n  const contentWarning = store.getComposeData(realm, 'contentWarning')\n  const newShown = !shown\n  store.setComposeData(realm, {\n    contentWarning: newShown ? contentWarning : '',\n    contentWarningShown: newShown,\n    sensitive: contentWarning && newShown // toggling content warning automatically toggles sensitive media\n  })\n}\n","import { store } from '../_store/store.js'\n\nexport function enablePoll (realm) {\n  store.setComposeData(realm, {\n    poll: {\n      options: [\n        '',\n        ''\n      ]\n    }\n  })\n}\n\nexport function disablePoll (realm) {\n  store.setComposeData(realm, {\n    poll: null\n  })\n}\n","<LengthGauge style=\"grid-area: gauge; margin: -2px 0 5px 5px; clip-path: inset(-20px 0 0 0 round calc(var(--input-border-radius-size)));\"\n       {length}\n       {overLimit}\n       max={$maxStatusChars}\n/>\n<script>\n  import LengthGauge from '../LengthGauge.html'\n  import { store } from '../../_store/store.js'\n\n  export default {\n    components: {\n      LengthGauge\n    },\n    store: () => store\n  }\n</script>\n","<a {href}\n   rel=\"prefetch\"\n   class=\"compose-box-avatar {loaded ? 'loaded' : 'not-loaded'}\"\n   aria-hidden=\"true\"\n   tabindex=\"-1\"\n   on:click=\"onClick(event)\"\n>\n  <!-- the avatar is duplicated information, so hide from tab order and screenreaders -->\n  <Avatar account={verifyCredentials} size={avatarSize} />\n</a>\n<a class=\"compose-box-display-name {loaded ? 'loaded' : 'not-loaded'}\"\n   {href}\n   aria-busy={!loaded}\n   aria-live=\"off\"\n   rel=\"prefetch\"\n   on:click=\"onClick(event)\"\n>\n  <AccountDisplayName account={verifyCredentials} />\n</a>\n\n<span class=\"compose-box-handle {loaded ? 'loaded' : 'not-loaded'}\"\n      aria-busy={!loaded}\n      aria-live=\"off\"\n>\n  {'@' + verifyCredentials.acct}\n</span>\n<style>\n  .compose-box-avatar {\n    grid-area: avatar;\n    margin-right: 15px;\n  }\n  .compose-box-display-name {\n    color: var(--deemphasized-text-color);\n    grid-area: name;\n    min-width: 0;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 1.1em;\n    margin-left: 5px;\n    font-weight: 600;\n  }\n  .compose-box-display-name,\n  .compose-box-display-name:hover,\n  .compose-box-display-name:visited {\n    color: var(--body-text-color);\n  }\n  :global(.compose-box-handle) {\n    grid-area: handle;\n    color: var(--deemphasized-text-color);\n    min-width: 0;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    font-size: 1.1em;\n    margin-left: 5px;\n  }\n  .not-loaded {\n    visibility: hidden;\n  }\n  .loaded {\n    visibility: visible;\n  }\n\n  @media (max-width: 767px) {\n    .compose-box-avatar {\n      margin-right: 5px;\n    }\n  }\n  @media (max-width: 240px) {\n    .compose-box-avatar {\n      margin-right: 0;\n    }\n  }\n</style>\n<script>\n  import Avatar from '../Avatar.html'\n  import { store } from '../../_store/store.js'\n  import AccountDisplayName from '../profile/AccountDisplayName.html'\n  import { ONE_TRANSPARENT_PIXEL } from '../../_static/media.js'\n  import { emit } from '../../_utils/eventBus.js'\n  import { goto } from '../../../../__sapper__/client.js'\n\n  export default {\n    components: {\n      Avatar,\n      AccountDisplayName\n    },\n    store: () => store,\n    computed: {\n      loaded: ({ $currentVerifyCredentials }) => !!$currentVerifyCredentials,\n      verifyCredentials: ({ $currentVerifyCredentials }) => {\n        // return a placeholder while we're waiting on IndexedDB to load\n        return $currentVerifyCredentials || {\n          display_name: '',\n          acct: '',\n          avatar: ONE_TRANSPARENT_PIXEL,\n          avatar_static: ONE_TRANSPARENT_PIXEL\n        }\n      },\n      id: ({ verifyCredentials }) => (verifyCredentials && verifyCredentials.id),\n      href: ({ id }) => (id ? `/accounts/${id}` : '#'),\n      avatarSize: ({ $isVeryTinyMobileSize }) => $isVeryTinyMobileSize ? 'extra-small' : 'small'\n    },\n    methods: {\n      onClick (e) {\n        const { realm, dialogId, href } = this.get()\n        if (realm === 'dialog') {\n          e.preventDefault()\n          e.stopPropagation()\n          // in dialog mode, we have to close the dialog and then navigate to the profile\n          emit('closeDialog', dialogId)\n          setTimeout(() => { // setTimeout to work around dialog navigation issues\n            goto(href)\n          })\n        }\n      }\n    }\n  }\n</script>\n","import { store } from '../_store/store.js'\n\nconst emojiMapper = emoji => emoji.unicode ? emoji.unicode : `:${emoji.shortcodes[0]}:`\nconst hashtagMapper = hashtag => `#${hashtag.name}`\nconst accountMapper = account => `@${account.acct}`\n\nasync function insertTextAtPosition (realm, text, startIndex, endIndex) {\n  const { currentInstance } = store.get()\n  const oldText = store.getComposeData(realm, 'text')\n  const pre = oldText.substring(0, startIndex)\n  const post = oldText.substring(endIndex)\n  const newText = `${pre}${text} ${post}`\n  store.setComposeData(realm, { text: newText })\n  store.setForAutosuggest(currentInstance, realm, { autosuggestSearchResults: [] })\n}\n\nexport async function insertUsername (realm, account, startIndex, endIndex) {\n  await insertTextAtPosition(realm, accountMapper(account), startIndex, endIndex)\n}\n\nexport async function insertHashtag (realm, hashtag, startIndex, endIndex) {\n  await insertTextAtPosition(realm, hashtagMapper(hashtag), startIndex, endIndex)\n}\n\nexport async function insertEmojiAtPosition (realm, emoji, startIndex, endIndex) {\n  await insertTextAtPosition(realm, emojiMapper(emoji), startIndex, endIndex)\n}\n\nasync function clickSelectedItem (realm, resultMapper) {\n  const {\n    composeSelectionStart,\n    autosuggestSearchText,\n    autosuggestSelected,\n    autosuggestSearchResults\n  } = store.get()\n  const result = autosuggestSearchResults[autosuggestSelected]\n  const startIndex = composeSelectionStart - autosuggestSearchText.length\n  const endIndex = composeSelectionStart\n  await insertTextAtPosition(realm, resultMapper(result), startIndex, endIndex)\n}\n\nexport async function clickSelectedAutosuggestionUsername (realm) {\n  return clickSelectedItem(realm, accountMapper)\n}\n\nexport async function clickSelectedAutosuggestionHashtag (realm) {\n  return clickSelectedItem(realm, hashtagMapper)\n}\n\nexport async function clickSelectedAutosuggestionEmoji (realm) {\n  return clickSelectedItem(realm, emojiMapper)\n}\n\nexport function selectAutosuggestItem (item) {\n  const {\n    currentComposeRealm,\n    composeSelectionStart,\n    autosuggestSearchText\n  } = store.get()\n  const startIndex = composeSelectionStart - autosuggestSearchText.length\n  const endIndex = composeSelectionStart\n  if (item.acct) {\n    /* no await */ insertUsername(currentComposeRealm, item, startIndex, endIndex)\n  } else if (item.shortcodes) {\n    /* no await */ insertEmojiAtPosition(currentComposeRealm, item, startIndex, endIndex)\n  } else { // hashtag\n    /* no await */ insertHashtag(currentComposeRealm, item, startIndex, endIndex)\n  }\n}\n","import { thunk } from '../thunk.js'\n\nexport const isWebKit = thunk(() => process.browser && typeof webkitIndexedDB !== 'undefined')\n","<textarea\n  id=\"the-compose-box-input-{realm}\"\n  class=\"compose-box-input compose-box-input-realm-{realm}\"\n  placeholder=\"What's on your mind?\"\n  aria-describedby=\"compose-box-input-description-{realm}\"\n  aria-owns=\"compose-autosuggest-list-{realm}\"\n  aria-expanded={autosuggestShownForThisInput}\n  aria-autocomplete=\"both\"\n  aria-activedescendant={activeDescendant}\n  ref:textarea\n  bind:value=rawText\n  on:focus=\"onFocus()\"\n  on:blur=\"onBlur()\"\n  on:selectionChange=\"onSelectionChange(event)\"\n  on:keydown=\"onKeydown(event)\"\n></textarea>\n<label for=\"the-compose-box-input-{realm}\" class=\"sr-only\">\n  What's on your mind?\n</label>\n<span id=\"compose-box-input-description-{realm}\" class=\"sr-only\">\n  When autocomplete results are available, press up or down arrows and enter to select.\n</span>\n<style>\n  .compose-box-input {\n    grid-area: input;\n    margin: 10px 0 0 5px;\n    padding: 10px;\n    border: 1px solid var(--input-border);\n    min-height: 75px;\n    resize: none;\n    overflow: hidden;\n    word-wrap: break-word;\n    /* Text must be at least 16px or else iOS Safari zooms in */\n    font-size: 1.2em;\n    /* Hack to make Edge stretch the element all the way to the right.\n     * Also desktop Safari makes the gauge stretch too far to the right without it.\n     */\n    width: calc(100% - 5px);\n  }\n\n  .compose-box-input-realm-dialog {\n    max-height: 40vh;\n    overflow-y: auto;\n  }\n\n  @media (max-width: 767px) {\n    .compose-box-input-realm-dialog {\n      max-height: 30vh;\n    }\n  }\n\n  @media (max-width: 479px) {\n    .compose-box-input-realm-dialog {\n      max-height: 20vh;\n    }\n  }\n</style>\n<script>\n  import { store } from '../../_store/store.js'\n  import { autosize } from '../../_thirdparty/autosize/autosize.js'\n  import { scheduleIdleTask } from '../../_utils/scheduleIdleTask.js'\n  import { mark, stop } from '../../_utils/marks.js'\n  import { selectionChange } from '../../_utils/events.js'\n  import {\n    clickSelectedAutosuggestionUsername,\n    clickSelectedAutosuggestionEmoji, clickSelectedAutosuggestionHashtag\n  } from '../../_actions/autosuggest.js'\n  import { observe } from 'svelte-extras'\n  import { get } from '../../_utils/lodash-lite.js'\n  import { on } from '../../_utils/eventBus.js'\n  import { requestPostAnimationFrame } from '../../_utils/requestPostAnimationFrame.js'\n  import { throttleTimer } from '../../_utils/throttleTimer.js'\n  import { isWebKit } from '../../_utils/userAgent/isWebKit.js'\n\n  const updateComposeTextInStore = throttleTimer(scheduleIdleTask)\n\n  export default {\n    oncreate () {\n      this.setupSyncFromStore()\n      this.setupSyncToStore()\n      this.setupAutosize()\n      this.setupResize()\n      this.setCursorIfNecessary()\n    },\n    ondestroy () {\n      this.teardownAutosize()\n    },\n    methods: {\n      observe,\n      setupSyncFromStore () {\n        const textarea = this.refs.textarea\n        let firstTime = true\n        this.observe('text', text => {\n          const { rawText } = this.get()\n          if (rawText !== text) {\n            let newSelectionStart\n            if (!firstTime) {\n              const { selectionStart, selectionEnd } = textarea\n              if (selectionStart > 0 && selectionStart === selectionEnd) {\n                // Preserve cursor position when doing an autosuggest.\n                // Note that we don't need to do anything special to measure length here, because\n                // the selectionStart value is not emoji-aware.\n                newSelectionStart = (text.length - rawText.length) + selectionStart\n              }\n            }\n            this.set({ rawText: text })\n            if (typeof newSelectionStart === 'number' && newSelectionStart > 0) {\n              textarea.selectionStart = textarea.selectionEnd = newSelectionStart\n            }\n            // this next autosize is required to resize after\n            // the user clicks the \"toot\" button\n            mark('autosize.update()')\n            autosize.update(textarea)\n            stop('autosize.update()')\n          }\n          if (firstTime) {\n            firstTime = false\n            const { autoFocus } = this.get()\n            if (autoFocus) {\n              const { realm } = this.get()\n              if (realm === 'dialog') {\n                // If we're in a dialog, the dialog will be hidden at this\n                // point. Also, the dialog has its own initial focus behavior.\n                // Tell the dialog to focus the textarea.\n                textarea.setAttribute('autofocus', true)\n              } else {\n                requestAnimationFrame(() => textarea.focus({ preventScroll: true }))\n              }\n            }\n          }\n        })\n      },\n      setupSyncToStore () {\n        const { realm } = this.get()\n        this.observe('rawText', rawText => {\n          updateComposeTextInStore(() => {\n            mark('updateComposeTextInStore')\n            this.store.setComposeData(realm, { text: rawText })\n            this.store.save()\n            stop('updateComposeTextInStore')\n          })\n        }, { init: false })\n      },\n      setupAutosize () {\n        const textarea = this.refs.textarea\n        requestPostAnimationFrame(() => {\n          mark('autosize()')\n          autosize(textarea)\n          stop('autosize()')\n        })\n      },\n      teardownAutosize () {\n        mark('autosize.destroy()')\n        autosize.destroy(this.refs.textarea)\n        stop('autosize.destroy()')\n      },\n      onBlur () {\n        requestAnimationFrame(() => {\n          this.store.setForCurrentAutosuggest({ composeFocused: false })\n        })\n      },\n      onFocus () {\n        scheduleIdleTask(() => {\n          const { realm } = this.get()\n          this.store.set({ currentComposeRealm: realm })\n          this.store.setForCurrentAutosuggest({ composeFocused: true })\n        })\n      },\n      onSelectionChange (selectionStart) {\n        scheduleIdleTask(() => {\n          this.store.setForCurrentAutosuggest({ composeSelectionStart: selectionStart })\n        })\n      },\n      onKeydown (e) {\n        const { keyCode } = e\n        // ctrl or cmd (on macs) was pressed; ctrl-enter means post a toot\n        const ctrlPressed = e.getModifierState('Control') || e.getModifierState('Meta')\n        switch (keyCode) {\n          case 9: { // tab\n            this.clickSelectedAutosuggestion(e)\n            break\n          }\n          case 13: { // enter\n            const autosuggestionClicked = this.clickSelectedAutosuggestion(e)\n            if (!autosuggestionClicked && ctrlPressed) {\n              this.fire('postAction')\n            }\n            break\n          }\n          case 38: { // up\n            this.incrementAutosuggestSelected(-1, e)\n            break\n          }\n          case 40: { // down\n            this.incrementAutosuggestSelected(1, e)\n            break\n          }\n          case 27: { // escape\n            this.clearAutosuggestions(e)\n            break\n          }\n          default:\n        }\n      },\n      clickSelectedAutosuggestion (event) {\n        const {\n          autosuggestShown,\n          autosuggestType\n        } = this.store.get()\n        if (!autosuggestShown) {\n          return false\n        }\n        event.preventDefault()\n        event.stopPropagation()\n\n        const clickAutosuggestedItem = async () => {\n          const { realm } = this.get()\n          /* autosuggestSelecting prevents a flash of searched content */\n          this.store.setForCurrentAutosuggest({ autosuggestSelecting: true })\n          if (autosuggestType === 'account') {\n            await clickSelectedAutosuggestionUsername(realm)\n          } else if (autosuggestType === 'hashtag') {\n            await clickSelectedAutosuggestionHashtag(realm)\n          } else { // emoji\n            await clickSelectedAutosuggestionEmoji(realm)\n          }\n          this.store.setForCurrentAutosuggest({ autosuggestSelecting: false })\n        }\n\n        /* no await */ clickAutosuggestedItem()\n        return true\n      },\n      incrementAutosuggestSelected (increment, event) {\n        let {\n          autosuggestShown,\n          autosuggestSelected,\n          autosuggestSearchResults\n        } = this.store.get()\n        if (!autosuggestShown) {\n          return\n        }\n        autosuggestSelected += increment\n        if (autosuggestSelected >= 0) {\n          autosuggestSelected = autosuggestSelected % autosuggestSearchResults.length\n        } else {\n          autosuggestSelected = autosuggestSearchResults.length + autosuggestSelected\n        }\n        this.store.setForCurrentAutosuggest({ autosuggestSelected })\n        event.preventDefault()\n        event.stopPropagation()\n      },\n      clearAutosuggestions (event) {\n        const { autosuggestShown } = this.store.get()\n        if (!autosuggestShown) {\n          return\n        }\n        this.store.setForCurrentAutosuggest({\n          autosuggestSearchResults: [],\n          autosuggestSelected: 0\n        })\n        event.preventDefault()\n        event.stopPropagation()\n      },\n      setupResize () {\n        on('resizeComposeInput', this, realm => {\n          if (realm === this.get().realm) {\n            autosize.update(this.refs.textarea)\n          }\n        })\n      },\n      setCursorIfNecessary () {\n        const { realm } = this.get()\n        if (isWebKit() && realm !== 'dialog' && realm !== 'home') {\n          // Place the cursor at the end of the textarea in replies if this is WebKit.\n          // Works around a Safari/WebKit bug\n          // We only do this for replies (not dialog/home) because for dialog/home we don't want to\n          // also focus the textarea, which is a side effect of setting selectionStart.\n          // Potentially we could run this logic for all browsers, but I don't want to deal with the potential\n          // perf hit or bugs of running more code for browsers that don't need it.\n          requestAnimationFrame(() => {\n            this.refs.textarea.selectionStart = this.refs.textarea.value.length\n          })\n        }\n      }\n    },\n    store: () => store,\n    data: () => ({\n      rawText: ''\n    }),\n    computed: {\n      /* eslint-disable camelcase */\n      composeFocused: ({ $autosuggestData_composeFocused, $currentInstance, realm }) => (\n        get($autosuggestData_composeFocused, [$currentInstance, realm], false)\n      ),\n\n      autosuggestShownForThisInput: ({ $autosuggestShown, composeFocused }) => (\n        !!($autosuggestShown && composeFocused)\n      ),\n      autosuggestSelected: ({ $autosuggestData_autosuggestSelected, $currentInstance, realm }) => (\n        get($autosuggestData_autosuggestSelected, [$currentInstance, realm], 0)\n      ),\n      activeDescendant: ({ autosuggestSelected, autosuggestShownForThisInput, realm }) => (\n        autosuggestShownForThisInput ? `compose-autosuggest-active-item-${realm}-${autosuggestSelected}` : undefined\n      )\n      /* eslint-enable camelcase */\n    },\n    events: {\n      selectionChange\n    }\n  }\n</script>\n","<div class=\"compose-box-button-halo {sticky ? 'compose-box-button-halo-sticky' : ''}\">\n  <button class=\"primary compose-box-button\"\n          {disabled}\n          aria-label={sticky ? 'Compose post' : label}\n          on:click>\n    <span class={$postingStatus || sticky ? 'hidden' : ''}>\n      {label}\n    </span>\n    <div class=\"compose-box-button-spinner\"\n         aria-hidden=\"true\">\n      <SvgIcon className=\"compose-box-button-svg {$postingStatus ? 'spin' : 'hidden'}\"\n               href=\"#fa-spinner\" />\n    </div>\n\n    <div class=\"compose-box-button-compose {sticky ? '' : 'hidden'}\"\n         aria-hidden=\"true\">\n      <SvgIcon className=\"compose-box-button-svg\"\n               href=\"#fa-pencil\" />\n    </div>\n  </button>\n</div>\n<style>\n  .compose-box-button-halo {\n    border-radius: 9px;\n    margin: 5px 15px 15px 5px;\n    pointer-events: auto;\n  }\n  .compose-box-button-halo-sticky {\n    background-color: var(--compose-button-halo);\n  }\n  .compose-box-button {\n    grid-area: button;\n    justify-self: right;\n    text-transform: uppercase;\n    position: relative;\n    margin: 5px;\n    pointer-events: auto;\n  }\n  .compose-box-button-spinner, .compose-box-button-compose {\n    position: absolute;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: 10;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n  }\n  :global(.compose-box-button-svg) {\n    width: 24px;\n    height: 24px;\n    fill: var(--button-primary-text);\n  }\n\n  @media (max-width: 767px) {\n    .compose-box-button-halo {\n      margin: 5px;\n    }\n    .compose-box-button {\n      margin: 5px;\n    }\n  }\n</style>\n<script>\n  import SvgIcon from '../SvgIcon.html'\n  import { store } from '../../_store/store.js'\n\n  export default {\n    store: () => store,\n    computed: {\n      disabled: ({ $postingStatus, overLimit }) => $postingStatus || overLimit,\n      label: ({ editId }) => editId ? 'Edit' : 'Post'\n    },\n    components: {\n      SvgIcon\n    }\n  }\n</script>\n","<div class=\"compose-box-button-sentinel\" ref:sentinel></div>\n<div class=\"{computedClass}\"\n     ref:wrapper >\n  <ComposeButton {overLimit} {sticky} {editId} on:click=\"onClickButton()\" />\n</div>\n<style>\n  .compose-box-button-wrapper {\n    /*\n     * We want pointer-events only for the sticky button, so use fit-content so that\n     * the element doesn't take up the full width, and then set its left margin to\n     * auto so that it sticks to the right. fit-content doesn't work in Edge, but\n     * that just means that content that is level with the button is not clickable.\n     */\n    width: -moz-fit-content;\n    width: fit-content;\n    margin-left: auto;\n    display: flex;\n    justify-content: flex-end;\n  }\n\n  .compose-box-button-sticky {\n    position: -webkit-sticky;\n    position: sticky;\n  }\n\n  :global(.compose-box-button-sticky, .compose-box-button-fixed) {\n    z-index: 5000;\n    top: calc(var(--fab-gap-top));\n  }\n</style>\n<script>\n  import ComposeButton from './ComposeButton.html'\n  import { store } from '../../_store/store.js'\n  import { importShowComposeDialog } from '../dialog/asyncDialogs/importShowComposeDialog.js'\n  import { observe } from 'svelte-extras'\n  import { classname } from '../../_utils/classname.js'\n\n  export default {\n    oncreate () {\n      this.setupIntersectionObservers()\n    },\n    ondestroy () {\n      this.teardownIntersectionObservers()\n    },\n    store: () => store,\n    data: () => ({\n      sticky: false\n    }),\n    computed: {\n      timelineInitialized: ({ $timelineInitialized }) => $timelineInitialized,\n      computedClass: ({ showSticky, hideAndFadeIn }) => (classname(\n        'compose-box-button-wrapper',\n        showSticky && 'compose-box-button-sticky',\n        hideAndFadeIn\n      ))\n    },\n    methods: {\n      observe,\n      onClickButton () {\n        const { sticky } = this.get()\n        if (sticky) {\n          // when the button is sticky, we're scrolled down the home timeline,\n          // so we should launch a new compose dialog\n          this.showDialog()\n        } else {\n          // else we're actually posting a new toot, let our parent know\n          this.fire('postAction')\n        }\n      },\n      async showDialog () {\n        (await importShowComposeDialog())()\n      },\n      setupIntersectionObservers () {\n        const { showSticky } = this.get()\n        if (!showSticky) {\n          return // no need to set up observers if this button can never be sticky (e.g. dialogs)\n        }\n        const sentinel = this.refs.sentinel\n\n        this.__stickyObserver = new IntersectionObserver(entries => this.onObserve(entries))\n        this.__stickyObserver.observe(sentinel)\n\n        // also create a one-shot observer for the $timelineInitialized event,\n        // due to a bug in Firefox where when the scrollTop is set\n        // manually, the other observer doesn't necessarily fire\n        this.observe('timelineInitialized', timelineInitialized => {\n          if (timelineInitialized && !this.__oneShotObserver) {\n            this.__oneShotObserver = new IntersectionObserver(entries => {\n              this.onObserve(entries)\n              this.__oneShotObserver.disconnect()\n              this.__oneShotObserver = null\n            })\n            this.__oneShotObserver.observe(sentinel)\n          }\n        }, { init: false })\n      },\n      onObserve (entries) {\n        this.set({ sticky: !entries[0].isIntersecting })\n      },\n      teardownIntersectionObservers () {\n        if (this.__stickyObserver) {\n          this.__stickyObserver.disconnect()\n          this.__stickyObserver = null\n        }\n        if (this.__oneShotObserver) {\n          this.__oneShotObserver.disconnect()\n          this.__oneShotObserver = null\n        }\n      }\n    },\n    components: {\n      ComposeButton\n    }\n  }\n</script>\n","export const importShowMediaEditDialog = () => import(\n  '../creators/showMediaEditDialog.js'\n).then(mod => mod.default)\n","<li class=\"compose-media compose-media-realm-{realm}\" aria-label={shortName}>\n  <img\n    alt=\"\"\n    class=\"{type === 'audio' ? 'audio-preview' : ''}\"\n    style=\"object-position: {objectPosition};\"\n    src={previewSrc}\n    aria-hidden=\"true\"\n  />\n  <div class=\"compose-media-buttons\">\n    <button class=\"compose-media-button compose-media-focal-button\"\n            aria-label=\"Edit\"\n            title=\"Edit\"\n            on:click=\"onEdit()\" >\n      <SvgIcon className=\"compose-media-button-svg\" href=\"#fa-pencil\" />\n    </button>\n    <button class=\"compose-media-button compose-media-delete-button\"\n            aria-label=\"Delete\"\n            title=\"Delete\"\n            on:click=\"onDeleteMedia()\" >\n      <SvgIcon className=\"compose-media-button-svg\" href=\"#fa-times\" />\n    </button>\n  </div>\n  <div class=\"compose-media-alt\">\n    <textarea id=\"compose-media-input-{uuid}\"\n           class=\"compose-media-alt-input\"\n           placeholder=\"Description\"\n           ref:textarea\n           bind:value=rawText\n    ></textarea>\n    <label for=\"compose-media-input-{uuid}\" class=\"sr-only\">\n      Describe for visually impaired (image, video) or auditorily impaired (audio, video) people\n    </label>\n  </div>\n</li>\n<style>\n  .compose-media {\n    margin: 0;\n    padding: 0;\n    height: 200px;\n    overflow: hidden;\n    flex-direction: column;\n    position: relative;\n    display: flex;\n    background: var(--main-bg);\n  }\n  .compose-media img {\n    object-fit: contain;\n    flex: 1;\n    height: 100%;\n    width: 100%;\n  }\n  .compose-media-alt {\n    z-index: 10;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    display: flex;\n    justify-content: center;\n  }\n  .compose-media-alt-input {\n    width: 100%;\n    font-size: 1.2em;\n    background: var(--alt-input-bg);\n    color: var(--body-text-color);\n    max-height: 100px;\n    border: 1px solid var(--input-border);\n    resize: none;\n  }\n  .compose-media-alt-input:focus {\n    background: var(--main-bg);\n  }\n  .compose-media-buttons {\n    position: absolute;\n    z-index: 10;\n    top: 0;\n    right: 0;\n    left: 0;\n    display: flex;\n    justify-content: space-between;\n    margin: 2px;\n  }\n  .compose-media-button {\n    padding: 7px 10px 5px;\n    background: var(--floating-button-bg);\n    border: 1px solid var(--button-border);\n  }\n  .compose-media-button:hover {\n    background: var(--floating-button-bg-hover);\n  }\n  .compose-media-button:active {\n    background: var(--floating-button-bg-active);\n  }\n  :global(.compose-media-button-svg) {\n    fill: var(--button-text);\n    width: 18px;\n    height: 18px;\n  }\n\n  .audio-preview {\n    background: var(--audio-bg);\n  }\n\n  .compose-media-realm-dialog {\n    max-height: 20vh;\n  }\n\n  @media (max-width: 767px) {\n    .compose-media-realm-dialog {\n      max-height: 15vh;\n    }\n    .compose-media-alt-input {\n      max-height: 7vh;\n    }\n  }\n\n  @media (max-width: 320px) {\n    .compose-media-realm-dialog .compose-media-alt-input {\n      display: none; /* too small to show this - use the edit button instead */\n    }\n  }\n</style>\n<script>\n  import { store } from '../../_store/store.js'\n  import { deleteMedia } from '../../_actions/media.js'\n  import { scheduleIdleTask } from '../../_utils/scheduleIdleTask.js'\n  import { observe } from 'svelte-extras'\n  import SvgIcon from '../SvgIcon.html'\n  import { autosize } from '../../_thirdparty/autosize/autosize.js'\n  import { ONE_TRANSPARENT_PIXEL } from '../../_static/media.js'\n  import { get } from '../../_utils/lodash-lite.js'\n  import { coordsToPercent } from '../../_utils/coordsToPercent.js'\n  import { importShowMediaEditDialog } from '../dialog/asyncDialogs/importShowMediaEditDialog.js'\n  import { throttleTimer } from '../../_utils/throttleTimer.js'\n\n  const updateMediaInStore = throttleTimer(scheduleIdleTask)\n  const resizeTextarea = process.browser && throttleTimer(requestAnimationFrame)\n\n  export default {\n    oncreate () {\n      this.setupSyncFromStore()\n      this.setupSyncToStore()\n      this.setupAutosize()\n    },\n    ondestroy () {\n      this.teardownAutosize()\n    },\n    data: () => ({\n      rawText: '',\n      focusX: 0,\n      focusY: 0\n    }),\n    computed: {\n      type: ({ mediaItem }) => mediaItem.data.type,\n      shortName: ({ mediaItem }) => (\n        // sometimes we no longer have the file, e.g. in a delete and redraft situation,\n        // so fall back to the description if it was provided\n        get(mediaItem, ['file', 'name']) || get(mediaItem, ['description']) || 'media'\n      ),\n      previewSrc: ({ mediaItem, type }) => (\n        type === 'audio' ? ONE_TRANSPARENT_PIXEL : mediaItem.data.preview_url\n      ),\n      uuid: ({ realm, mediaItem }) => `${realm}-${mediaItem.data.id}`,\n      objectPosition: ({ focusX, focusY }) => {\n        if (!focusX && !focusY) {\n          return 'center center'\n        }\n        return `${coordsToPercent(focusX)}% ${100 - coordsToPercent(focusY)}%`\n      }\n    },\n    store: () => store,\n    methods: {\n      observe,\n      setupSyncFromStore () {\n        this.observe('media', media => {\n          media = media || []\n          const { index, rawText } = this.get()\n          const text = get(media, [index, 'description'], '')\n          if (rawText !== text) {\n            this.set({ rawText: text })\n            resizeTextarea(() => autosize.update(this.refs.textarea))\n          }\n          const focusX = get(media, [index, 'focusX'], 0)\n          const focusY = get(media, [index, 'focusY'], 0)\n          this.set({ focusX, focusY })\n        })\n      },\n      setupSyncToStore () {\n        this.observe('rawText', rawText => {\n          updateMediaInStore(() => {\n            const { realm, index, media } = this.get()\n            if (media[index].description !== rawText) {\n              media[index].description = rawText\n              this.store.setComposeData(realm, { media })\n              this.store.save()\n            }\n          })\n        }, { init: false })\n      },\n      setupAutosize () {\n        autosize(this.refs.textarea)\n      },\n      teardownAutosize () {\n        autosize.destroy(this.refs.textarea)\n      },\n      onDeleteMedia () {\n        const { realm, index } = this.get()\n        deleteMedia(realm, index)\n      },\n      async onEdit () {\n        const { realm, index, type } = this.get()\n        const showMediaEditDialog = await importShowMediaEditDialog()\n        showMediaEditDialog(realm, index, type)\n      }\n    },\n    components: {\n      SvgIcon\n    }\n  }\n</script>\n","{#if media.length}\n  <ul class=\"compose-media-container\"\n      aria-label=\"Media uploads\"\n      style=\"grid-template-columns: repeat({Math.min(media.length, 4)}, 1fr);\"\n  >\n    {#each media as mediaItem, index}\n      <ComposeMediaItem {realm} {mediaItem} {index} {media} />\n    {/each}\n  </ul>\n{/if}\n<style>\n  .compose-media-container {\n    grid-area: media;\n    list-style: none;\n    display: grid;\n    grid-gap: 5px;\n    align-items: center;\n    justify-content: center;\n    margin: 10px 0 0 0;\n    background: var(--form-bg);\n    padding: 5px;\n    border-radius: 4px;\n  }\n</style>\n<script>\n  import { store } from '../../_store/store.js'\n  import ComposeMediaItem from './ComposeMediaItem.html'\n\n  export default {\n    store: () => store,\n    components: {\n      ComposeMediaItem\n    }\n  }\n</script>\n","<input class=\"content-warning-input\"\n       type=\"text\"\n       placeholder=\"Content warning\"\n       aria-label=\"Content warning\"\n       bind:value=rawText\n/>\n<style>\n  .content-warning-input {\n    font-size: 1.2em;\n    margin: 10px 0 0 5px;\n    padding: 10px;\n    border: 1px solid var(--input-border);\n    width: calc(100% - 5px);\n  }\n</style>\n<script>\n  import { store } from '../../_store/store.js'\n  import { scheduleIdleTask } from '../../_utils/scheduleIdleTask.js'\n  import { observe } from 'svelte-extras'\n  import { throttleTimer } from '../../_utils/throttleTimer.js'\n\n  const updateContentWarningInStore = throttleTimer(scheduleIdleTask)\n\n  export default {\n    oncreate () {\n      this.setupSyncFromStore()\n      this.setupSyncToStore()\n    },\n    store: () => store,\n    data: () => ({\n      rawText: ''\n    }),\n    methods: {\n      observe,\n      setupSyncFromStore () {\n        this.observe('contentWarning', contentWarning => {\n          this.set({ rawText: contentWarning })\n        })\n      },\n      setupSyncToStore () {\n        const { realm } = this.get()\n        this.observe('rawText', rawText => {\n          updateContentWarningInStore(() => {\n            this.store.setComposeData(realm, {\n              sensitive: !!rawText, // toggling the content warning automatically toggles sensitive media\n              contentWarning: rawText\n            })\n            this.store.save()\n          })\n        }, { init: false })\n      }\n    }\n  }\n</script>\n","<file-drop multiple class=\"file-drop file-drop-realm-{realm}\" accept={mediaAccept} ref:fileDrop >\n  <div class=\"file-drop-info\">\n    <div class=\"file-drop-info-text\">\n      <span class=\"file-drop-info-text-valid\">Drop to upload</span>\n      <span class=\"file-drop-info-text-invalid\">Invalid file type</span>\n    </div>\n  </div>\n  <slot></slot>\n</file-drop>\n<style>\n  .file-drop {\n    display: block;\n    position: relative;\n    max-width: 100%;\n    width: 100%;\n  }\n\n  .file-drop-info {\n    display: none;\n    pointer-events: none;\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 6000;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .file-drop-info-text {\n    font-size: 1.2em;\n    color: var(--button-text);\n    padding: 10px 20px;\n    border: 2px dashed var(--button-text);\n    border-radius: 6px;\n  }\n\n  .file-drop-realm-dialog {\n    max-height: 100%;\n    overflow-y: auto;\n    overflow-x: hidden;\n    scrollbar-width: none;\n    -ms-overflow-style: none;\n  }\n\n  .file-drop-realm-dialog::-webkit-scrollbar {\n    display: none;\n  }\n\n  :global(.file-drop.drop-valid .file-drop-info, .file-drop.drop-invalid .file-drop-info) {\n    display: flex;\n    background: var(--file-drop-mask);\n  }\n\n  :global(.file-drop.drop-valid .file-drop-info-text-invalid, .file-drop.drop-invalid .file-drop-info-text-valid) {\n    display: none;\n  }\n</style>\n<script>\n  import { mediaAccept } from '../../_static/media.js'\n  import { doMediaUpload } from '../../_actions/media.js'\n  if (process.browser) {\n    require('file-drop-element')\n  }\n  export default {\n    oncreate () {\n      this.onFileDrop = this.onFileDrop.bind(this)\n      this.refs.fileDrop.addEventListener('filedrop', this.onFileDrop)\n    },\n    ondestroy () {\n      this.refs.fileDrop.removeEventListener('filedrop', this.onFileDRop)\n    },\n    data: () => ({\n      mediaAccept\n    }),\n    methods: {\n      async onFileDrop (e) {\n        const { files } = e\n        const { realm } = this.get()\n        for (const file of files) { // upload one at a time to avoid hitting limits\n          await doMediaUpload(realm, file)\n        }\n      }\n    }\n  }\n</script>\n","<!-- accessible autocomplete, based on https://haltersweb.github.io/Accessibility/autocomplete.html -->\n<ul id=\"compose-autosuggest-list-{realm}\"\n    class=\"compose-autosuggest-list\"\n    role=\"listbox\"\n>\n  {#each items as item, i (item.shortcodes ? `emoji-${item.unicode || item.name}` : item.id ? `account-${item.id}` : `hashtag-${item.name}`)}\n  <li id=\"compose-autosuggest-active-item-{realm}-{i}\"\n      class=\"compose-autosuggest-list-item {i === selected ? 'selected' : ''}\"\n      role=\"option\"\n      aria-selected=\"{i === selected}\"\n      on:click=\"onClick(event, item)\"\n  >\n    <!-- aria-label would be simpler than an sr-only element, but that breaks VoiceOver+Safari -->\n      <span class=\"sr-only\">{ariaLabels[i]}</span>\n      <div class=\"compose-autosuggest-list-grid\" aria-hidden=\"true\">\n        {#if type === 'account'}\n          <div class=\"compose-autosuggest-list-item-avatar\">\n            <Avatar\n              size=\"{$isVeryTinyMobileSize ? 'extra-small' : 'small'}\"\n              account={item}\n            />\n          </div>\n          <span class=\"compose-autosuggest-list-display-name\">\n              <AccountDisplayName account={item} />\n          </span>\n          <span class=\"compose-autosuggest-list-username\">\n              {'@' + item.acct}\n          </span>\n        {:elseif type === 'hashtag'}\n          <SvgIcon\n              href=\"#fa-hashtag\"\n              ariaHidden={true}\n              className=\"compose-autosuggest-list-item-icon\"\n          />\n          <span class=\"compose-autosuggest-list-display-name compose-autosuggest-list-display-name-single\">\n            {item.name}\n          </span>\n        {:else} <!-- emoji -->\n          {#if item.url}\n            <!-- custom emoji -->\n            <img src={item.url}\n                 class=\"compose-autosuggest-list-item-icon\"\n                 alt=\"\"\n                 aria-hidden=\"true\"\n            />\n          {:else}\n            <!-- native emoji -->\n            <span class=\"compose-autosuggest-list-item-icon compose-autosuggest-list-item-native-emoji\">\n              {item.unicode}\n            </span>\n          {/if}\n          <span class=\"compose-autosuggest-list-display-name compose-autosuggest-list-display-name-single\">\n              {item.shortcodes.map(_ => `:${_}:`).join(' ')}\n          </span>\n        {/if}\n      </div>\n  </li>\n  {/each}\n</ul>\n<style>\n  .compose-autosuggest-list {\n    list-style: none;\n    width: 100%;\n    border-radius: 2px;\n    box-sizing: border-box;\n    border: 1px solid var(--compose-autosuggest-outline);\n  }\n  .compose-autosuggest-list-item {\n    border-bottom: 1px solid var(--compose-autosuggest-outline);\n    display: flex;\n    padding: 10px;\n    background: var(--settings-list-item-bg);\n    margin: 0;\n    flex: 1;\n    cursor: pointer;\n  }\n  .compose-autosuggest-list-item:last-child {\n    border-bottom: none;\n  }\n  .compose-autosuggest-list-grid {\n    display: grid;\n    width: 100%;\n    grid-template-areas: \"icon     display-name\"\n                         \"icon     username\";\n    grid-template-columns: min-content 1fr;\n    grid-column-gap: 10px;\n    grid-row-gap: 5px;\n  }\n  :global(.compose-autosuggest-list-item-avatar) {\n    grid-area: icon;\n  }\n  :global(.compose-autosuggest-list-item-icon) {\n    grid-area: icon;\n    width: 48px;\n    height: 48px;\n    object-fit: contain;\n    fill: var(--deemphasized-text-color);\n  }\n  .compose-autosuggest-list-item-native-emoji {\n    font-family: CountryFlagEmojiPolyfill, PinaforeEmoji, 'Noto Color Emoji';\n    font-size: 32px;\n    line-height: 1;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n  .compose-autosuggest-list-display-name {\n    grid-area: display-name;\n    font-size: 1.1em;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    min-width: 0;\n    text-align: left;\n  }\n  .compose-autosuggest-list-display-name-single {\n    grid-row: 1 / 3;\n    align-self: center;\n  }\n  .compose-autosuggest-list-username {\n    grid-area: username;\n    font-size: 1em;\n    color: var(--deemphasized-text-color);\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    text-align: left;\n  }\n  .compose-autosuggest-list-item:hover, .compose-autosuggest-list-item.selected {\n    background: var(--compose-autosuggest-item-hover);\n  }\n  .compose-autosuggest-list-item:active {\n    background: var(--compose-autosuggest-item-active);\n  }\n\n  @media (max-width: 320px) {\n    .compose-autosuggest-list-item {\n      padding: 5px;\n    }\n    .compose-autosuggest-list-grid {\n      grid-column-gap: 5px;\n    }\n    :global(.compose-autosuggest-list-item-icon) {\n      width: 24px;\n      height: 24px;\n    }\n    .compose-autosuggest-list-item-native-emoji {\n      font-size: 18px;\n    }\n  }\n</style>\n<script>\n  import Avatar from '../Avatar.html'\n  import { store } from '../../_store/store.js'\n  import AccountDisplayName from '../profile/AccountDisplayName.html'\n  import { createAutosuggestAccessibleLabel } from '../../_utils/createAutosuggestAccessibleLabel.js'\n  import SvgIcon from '../SvgIcon.html'\n\n  export default {\n    store: () => store,\n    computed: {\n      ariaLabels: ({ items, type, $omitEmojiInDisplayNames }) => {\n        return items.map((item, i) => {\n          return createAutosuggestAccessibleLabel(type, $omitEmojiInDisplayNames, i, items)\n        })\n      }\n    },\n    methods: {\n      onClick (event, item) {\n        event.preventDefault()\n        event.stopPropagation()\n        this.fire('click', item)\n      }\n    },\n    components: {\n      Avatar,\n      AccountDisplayName,\n      SvgIcon\n    }\n  }\n</script>\n","import { removeEmoji } from './removeEmoji.js'\n\nexport function createAutosuggestAccessibleLabel (\n  autosuggestType, $omitEmojiInDisplayNames,\n  selectedIndex, searchResults) {\n  const selected = searchResults[selectedIndex]\n  let label\n  if (autosuggestType === 'emoji') {\n    label = selected.name || [selected.unicode].concat(selected.shortcodes).join(', ')\n  } else if (autosuggestType === 'hashtag') {\n    label = `#${selected.name}`\n  } else { // account\n    let displayName = selected.display_name || selected.username\n    const emojis = selected.emojis || []\n    displayName = $omitEmojiInDisplayNames\n      ? removeEmoji(displayName, emojis) || displayName\n      : displayName\n    label = `${displayName} @${selected.acct}`\n  }\n  return label\n}\n","<div class=\"compose-autosuggest {shown ? '' : 'not-shown'} {realm === 'dialog' ? 'is-dialog' : ''}\"\n     style=\"top: {top}px; --autosuggest-input-left: {left}px;\"\n>\n  <ComposeAutosuggestionList\n    items={autosuggestSearchResults}\n    on:click=\"onClick(event)\"\n    type={autosuggestType}\n    selected={autosuggestSelected}\n    {realm}\n  />\n</div>\n<style>\n  .compose-autosuggest {\n    position: absolute;\n    z-index: 90;\n    --autosuggest-input-left: 0; /* overridden by \"left\" prop passed in */\n    --autosuggest-left-offset: 5px;\n    /* In desktop mode, the autosuggest tracks the position of the input (the \"left\" prop passed in). */\n    left: calc(var(--autosuggest-input-left) + var(--autosuggest-left-offset));\n  }\n  .compose-autosuggest.not-shown {\n    display: none;\n  }\n\n  /* desktop styles */\n  @media (min-width: 480px) {\n    .compose-autosuggest {\n      min-width: 400px;\n      max-width: calc(100% - 20px);\n    }\n  }\n\n  /* mobile size */\n  @media (max-width: 479px) {\n    .compose-autosuggest {\n      /* on mobile, make it fill the viewport width */\n      --autosuggest-left-offset: 10px;\n      left: var(--autosuggest-left-offset);\n      width: calc(100vw - (2 * var(--autosuggest-left-offset)));\n    }\n  }\n\n  /* tiny mobile size */\n  @media (max-width: 240px) {\n    .compose-autosuggest {\n      --autosuggest-left-offset: 5px; /* make it bigger on tiny devices */\n    }\n    .compose-autosuggest.is-dialog {\n      --autosuggest-left-offset: 10px; /* more padding in dialogs */\n    }\n  }\n\n</style>\n<script>\n  import { store } from '../../_store/store.js'\n  import ComposeAutosuggestionList from './ComposeAutosuggestionList.html'\n  import { get } from '../../_utils/lodash-lite.js'\n  import { selectAutosuggestItem } from '../../_actions/autosuggest.js'\n  import { observe } from 'svelte-extras'\n  import { once } from '../../_utils/once.js'\n\n  export default {\n    oncreate () {\n      this._promiseChain = Promise.resolve()\n      this.observe('shouldBeShown', (shouldBeShown) => {\n        // TODO: hack so that when the user clicks the button, and the textarea blurs,\n        // we don't immediately hide the dropdown which would cause the click to get lost\n        this._promiseChain = this._promiseChain.then(() => {\n          if (!shouldBeShown) {\n            return Promise.race([\n              new Promise(resolve => setTimeout(resolve, 200)),\n              new Promise(resolve => this.once('autosuggestItemSelected', resolve))\n            ])\n          }\n        }).then(() => {\n          this.set({ shown: shouldBeShown })\n          this.store.setForCurrentAutosuggest({ autosuggestSelecting: false })\n        })\n      })\n    },\n    methods: {\n      observe,\n      once,\n      onClick (item) {\n        /* autosuggestSelecting prevents a flash of searched content */\n        this.store.setForCurrentAutosuggest({ autosuggestSelecting: true })\n        this.fire('autosuggestItemSelected')\n        selectAutosuggestItem(item)\n      }\n    },\n    computed: {\n      /* eslint-disable camelcase */\n      composeSelectionStart: ({ $autosuggestData_composeSelectionStart, $currentInstance, realm }) => (\n        get($autosuggestData_composeSelectionStart, [$currentInstance, realm], 0)\n      ),\n      composeFocused: ({ $autosuggestData_composeFocused, $currentInstance, realm }) => (\n        get($autosuggestData_composeFocused, [$currentInstance, realm], false)\n      ),\n      autosuggestSearchResults: ({ $autosuggestData_autosuggestSearchResults, $currentInstance, realm }) => (\n        get($autosuggestData_autosuggestSearchResults, [$currentInstance, realm], [])\n      ),\n      autosuggestType: ({ $autosuggestData_autosuggestType, $currentInstance, realm }) => (\n        get($autosuggestData_autosuggestType, [$currentInstance, realm])\n      ),\n      autosuggestSelected: ({ $autosuggestData_autosuggestSelected, $currentInstance, realm }) => (\n        get($autosuggestData_autosuggestSelected, [$currentInstance, realm], 0)\n      ),\n      autosuggestSearchText: ({ $autosuggestData_autosuggestSelected, $currentInstance, realm }) => (\n        get($autosuggestData_autosuggestSelected, [$currentInstance, realm])\n      ),\n      /* eslint-enable camelcase */\n      shouldBeShown: ({ $autosuggestShown, composeFocused }) => (\n        !!($autosuggestShown && composeFocused)\n      )\n    },\n    data: () => ({\n      shown: false,\n      top: 0\n    }),\n    store: () => store,\n    components: {\n      ComposeAutosuggestionList\n    }\n  }\n</script>\n","// svelte helper to add a .once() method similar to .on, but only fires once\n\nexport function once (eventName, callback) {\n  const listener = this.on(eventName, eventValue => {\n    listener.cancel()\n    callback(eventValue)\n  })\n}\n","<div class=\"compose-autosuggest-anchor-point\" ref:anchor></div>\n<style>\n  .compose-autosuggest-anchor-point {\n    grid-area: autosuggest;\n    width: 100%;\n    height: 0;\n  }\n</style>\n<script>\n  import ComposeAutosuggestContainer from './ComposeAutosuggestContainer.html'\n  import { requestPostAnimationFrame } from '../../_utils/requestPostAnimationFrame.js'\n  import { observe } from 'svelte-extras'\n  import { throttleTimer } from '../../_utils/throttleTimer.js'\n  import { on } from '../../_utils/eventBus.js'\n  import { store } from '../../_store/store.js'\n  import { addScrollListener, getScrollContainer, removeScrollListener } from '../../_utils/scrollContainer.js'\n  import { get } from '../../_utils/lodash-lite.js'\n  import { registerResizeListener, unregisterResizeListener } from '../../_utils/resize.js'\n\n  const updatePosition = process.browser && throttleTimer(requestAnimationFrame)\n\n  export default {\n    oncreate () {\n      const { dialogId } = this.get()\n      this.onResize = () => updatePosition(() => this.doResize())\n      let setupDone = false\n      if (this.get().realm === 'dialog') {\n        // wait for dialog to render first\n        on('dialogDidRender', this, id => {\n          if (id === dialogId && !setupDone) {\n            setupDone = true\n            this.setup()\n          }\n        })\n      } else {\n        setupDone = true\n        this.setup()\n      }\n    },\n    ondestroy () {\n      if (this._autosuggest) {\n        this._autosuggest.destroy()\n        this._autosuggest = null\n      }\n      if (this._element) {\n        this._element.remove()\n      }\n      unregisterResizeListener(this.onResize)\n      removeScrollListener(this.onResize)\n    },\n    methods: {\n      observe,\n      setup () {\n        const { realm, text, dialogId } = this.get()\n        requestAnimationFrame(() => {\n          const id = `the-autosuggest-container-${realm}`\n          this._element = document.getElementById(id)\n          if (!this._element) {\n            this._element = document.createElement('div')\n            this._element.id = id\n            const parent = realm === 'dialog' ? document.querySelector('.modal-dialog-contents') : document.body\n            parent.appendChild(this._element) // write\n          }\n          requestPostAnimationFrame(() => {\n            const { left, top } = this.calculateLeftAndTop()\n            this._autosuggest = new ComposeAutosuggestContainer({\n              target: this._element,\n              data: {\n                realm,\n                text,\n                dialogId,\n                left,\n                top\n              }\n            })\n            this.observe('text', text => {\n              this._autosuggest.set({ text })\n            }, { init: false })\n            this.observe('shouldBeShown', shouldBeShown => {\n              if (shouldBeShown) {\n                this.onResize() // just in case the window size changed while we weren't focused\n              }\n            })\n            registerResizeListener(this.onResize)\n            addScrollListener(this.onResize)\n          })\n        })\n      },\n      doResize () {\n        const { shouldBeShown } = this.get()\n        if (this._autosuggest && shouldBeShown) {\n          const { left, top } = this.calculateLeftAndTop()\n          console.log('updating autosuggest position', { left, top })\n          this._autosuggest.set({ left, top })\n        }\n      },\n      calculateLeftAndTop () {\n        const { anchor } = this.refs\n        const { realm } = this.get()\n        const { left, bottom } = anchor.getBoundingClientRect()\n        const yOffset = realm === 'dialog' ? 0 : getScrollContainer().scrollTop\n        return {\n          left,\n          top: bottom + yOffset\n        }\n      }\n    },\n    store: () => store,\n    computed: {\n      /* eslint-disable camelcase */\n      composeFocused: ({ $autosuggestData_composeFocused, $currentInstance, realm }) => (\n        get($autosuggestData_composeFocused, [$currentInstance, realm], false)\n      ),\n      /* eslint-enable camelcase */\n      shouldBeShown: ({ $autosuggestShown, composeFocused }) => (\n        !!($autosuggestShown && composeFocused)\n      )\n    }\n  }\n</script>\n","// Someday we can maybe replace this with Intl.DurationFormat\n// https://github.com/tc39/proposal-intl-duration-format\n\nexport const POLL_EXPIRY_OPTIONS = [\n  {\n    value: 300,\n    label: \"5 minutes\"\n  },\n  {\n    value: 1800,\n    label: \"30 minutes\"\n  },\n  {\n    value: 3600,\n    label: \"1 hour\"\n  },\n  {\n    value: 21600,\n    label: \"6 hours\"\n  },\n  {\n    value: 86400,\n    label: \"1 day\"\n  },\n  {\n    value: 259200,\n    label: \"3 days\"\n  },\n  {\n    value: 604800,\n    label: \"7 days\"\n  }\n]\n\nexport const POLL_EXPIRY_DEFAULT = 86400\n","<section class=\"compose-poll\" aria-label=\"Create poll\">\n    {#each poll.options as option, i}\n      <input id=\"poll-option-{realm}-{i}\"\n             type=\"text\"\n             maxlength=\"50\"\n             on:change=\"onChange(i)\"\n             placeholder=\"{createLabel(i)}\"\n\n      >\n      <IconButton\n        label=\"{createRemoveLabel(i)}\"\n        href=\"#fa-times\"\n        muted={true}\n        on:click=\"onDeleteClick(i)\"\n      />\n    {/each}\n  <div>\n    <input type=\"checkbox\"\n           id=\"poll-option-multiple-{realm}\"\n           on:change=\"onMultipleChange()\"\n    >\n    <label class=\"multiple-choice-label\"\n           for=\"poll-option-multiple-{realm}\">\n      Multiple choice\n    </label>\n    <Select className=\"poll-expiry-select\"\n            options={pollExpiryOptions}\n            defaultValue={pollExpiryDefaultValue}\n            on:change=\"onExpiryChange(event)\"\n            label=\"Poll duration\"\n    />\n  </div>\n  <IconButton\n    className=\"add-poll-choice-button\"\n    label=\"Add choice\"\n    href=\"#fa-plus\"\n    muted={true}\n    disabled={poll.options.length === 4}\n    on:click=\"onAddClick()\"\n  />\n  {#each poll.options as option, i}\n    <label id=\"poll-option-label-{realm}-{i}\"\n           class=\"sr-only\"\n           for=\"poll-option-{realm}-{i}\">\n      Choice {i + 1}\n    </label>\n  {/each}\n</section>\n<style>\n  .compose-poll {\n    margin: 10px 0 10px 5px;\n    display: grid;\n    grid-template-columns: minmax(0, max-content) max-content;\n    grid-row-gap: 10px;\n    align-items: center;\n  }\n\n  :global(.poll-expiry-select) {\n    margin-left: 10px;\n  }\n\n  .multiple-choice-label {\n    margin-left: 5px;\n  }\n\n  @media (max-width: 767px) {\n    :global(.poll-expiry-select) {\n      display: block;\n      margin-left: 0;\n      margin-top: 10px;\n    }\n    :global(.add-poll-choice-button) {\n      align-self: flex-start;\n    }\n  }\n</style>\n<script>\n  import IconButton from '../IconButton.html'\n  import Select from '../Select.html'\n  import { store } from '../../_store/store.js'\n  import { scheduleIdleTask } from '../../_utils/scheduleIdleTask.js'\n  import { POLL_EXPIRY_DEFAULT, POLL_EXPIRY_OPTIONS } from '../../_static/polls.js'\n  import { formatIntl } from '../../_utils/formatIntl.js'\n\n  function flushPollOptionsToDom (poll, realm) {\n    for (let i = 0; i < poll.options.length; i++) {\n      const element = document.getElementById(`poll-option-${realm}-${i}`)\n      element.value = poll.options[i]\n    }\n  }\n\n  export default {\n    oncreate () {\n      const { realm } = this.get()\n      const poll = this.store.getComposeData(realm, 'poll')\n      flushPollOptionsToDom(poll, realm)\n      document.getElementById(`poll-option-multiple-${realm}`).checked = !!poll.multiple\n      this.set({ pollExpiryDefaultValue: poll.expiry || POLL_EXPIRY_DEFAULT })\n    },\n    data: () => ({\n      pollExpiryOptions: POLL_EXPIRY_OPTIONS,\n      pollExpiryDefaultValue: POLL_EXPIRY_DEFAULT\n    }),\n    store: () => store,\n    helpers: {\n      createLabel (i) {\n        return formatIntl([\"Choice \",[\"index\"]], { index: i + 1 })\n      },\n      createRemoveLabel (i) {\n        return formatIntl([\"Remove choice \",[\"index\"]], { index: i + 1 })\n      }\n    },\n    methods: {\n      onChange (i) {\n        scheduleIdleTask(() => {\n          const { realm } = this.get()\n          const element = document.getElementById(`poll-option-${realm}-${i}`)\n          const poll = this.store.getComposeData(realm, 'poll')\n          poll.options[i] = element.value\n          this.store.setComposeData(realm, { poll })\n          this.store.save()\n        })\n      },\n      onMultipleChange () {\n        scheduleIdleTask(() => {\n          const { realm } = this.get()\n          const element = document.getElementById(`poll-option-multiple-${realm}`)\n          const poll = this.store.getComposeData(realm, 'poll')\n          poll.multiple = !!element.checked\n          this.store.setComposeData(realm, { poll })\n          this.store.save()\n        })\n      },\n      onDeleteClick (i) {\n        scheduleIdleTask(() => {\n          const { realm } = this.get()\n          const poll = this.store.getComposeData(realm, 'poll')\n          poll.options.splice(i, 1)\n          this.store.setComposeData(realm, { poll })\n          this.store.save()\n          flushPollOptionsToDom(poll, realm)\n        })\n      },\n      onAddClick () {\n        scheduleIdleTask(() => {\n          const { realm } = this.get()\n          const poll = this.store.getComposeData(realm, 'poll')\n          if (!poll.options.length !== 4) {\n            poll.options.push('')\n          }\n          this.store.setComposeData(realm, { poll })\n          this.store.save()\n        })\n      },\n      onExpiryChange (e) {\n        scheduleIdleTask(() => {\n          const { realm } = this.get()\n          const { value } = e.target\n          const poll = this.store.getComposeData(realm, 'poll')\n          poll.expiry = parseInt(value, 10)\n          this.store.setComposeData(realm, { poll })\n          this.store.save()\n        })\n      }\n    },\n    components: {\n      IconButton,\n      Select\n    }\n  }\n</script>\n","{#if media.length}\n  <div class=\"compose-media-sensitive\">\n    <label>\n      <input type=\"checkbox\" bind:checked=\"rawChecked\" {disabled} />\n      <span class=\"{disabled ? 'compose-sensitive-span-disabled' : ''}\">\n        Mark media as sensitive\n      </span>\n    </label>\n  </div>\n{/if}\n<style>\n  .compose-media-sensitive {\n    grid-area: sensitive;\n    margin-top: 10px;\n  }\n  label {\n    padding: 5px;\n    display: flex;\n    align-items: center;\n    justify-content: flex-start;\n  }\n  span {\n    margin-left: 5px;\n  }\n  .compose-sensitive-span-disabled {\n    color: var(--deemphasized-text-color);\n  }\n\n  @media (max-width: 767px) {\n    .compose-media-sensitive {\n      margin-top: 0;\n    }\n  }\n\n  @media (max-width: 320px) {\n    span {\n      font-size: 0.9em;\n    }\n  }\n\n</style>\n<script>\n  import { observe } from 'svelte-extras'\n  import { scheduleIdleTask } from '../../_utils/scheduleIdleTask.js'\n\n  export default {\n    oncreate () {\n      this.setupSyncToStore()\n      this.setupSyncFromStore()\n    },\n    data: () => ({\n      rawChecked: false\n    }),\n    computed: {\n      disabled: ({ contentWarning, contentWarningShown }) => contentWarning && contentWarningShown\n    },\n    methods: {\n      observe,\n      setupSyncToStore () {\n        this.observe('rawChecked', () => {\n          scheduleIdleTask(() => {\n            const { realm } = this.get()\n            const { rawChecked } = this.get()\n            const sensitive = this.store.getComposeData(realm, 'sensitive')\n            if (sensitive !== rawChecked) {\n              this.store.setComposeData(realm, { sensitive: rawChecked })\n              this.store.save()\n            }\n          })\n        }, { init: false })\n      },\n      setupSyncFromStore () {\n        this.observe('sensitive', sensitive => {\n          this.set({ rawChecked: sensitive })\n        })\n      }\n    }\n  }\n</script>\n","import { slide as svelteSlide } from 'svelte-transitions'\nimport { store } from '../_store/store.js'\nimport { noop } from '../_utils/lodash-lite.js'\n\n// same as svelte-transitions, but respecting reduceMotion\nexport function slide (node, ref) {\n  const { reduceMotion } = store.get()\n  if (reduceMotion) {\n    return {\n      delay: 0,\n      duration: 1, // setting to 0 causes some kind of built-in duration\n      easing: _ => _,\n      css: noop\n    }\n  }\n  return svelteSlide(node, ref)\n}\n","import { store } from '../_store/store.js'\nimport { toast } from '../_components/toast/toast.js'\nimport { postStatus as postStatusToServer, putStatus as putStatusToServer } from '../_api/statuses.js'\nimport { addStatusOrNotification } from './addStatusOrNotification.js'\nimport { database } from '../_database/database.js'\nimport { emit } from '../_utils/eventBus.js'\nimport { putMediaMetadata } from '../_api/media.js'\nimport { uniqBy } from '../_thirdparty/lodash/objects.js'\nimport { scheduleIdleTask } from '../_utils/scheduleIdleTask.js'\nimport { formatIntl } from '../_utils/formatIntl.js'\nimport { prepareToRehydrate, rehydrateStatusOrNotification } from './rehydrateStatusOrNotification.js'\n\nexport async function insertHandleForReply (statusId) {\n  const { currentInstance } = store.get()\n  const status = await database.getStatus(currentInstance, statusId)\n  const { currentVerifyCredentials } = store.get()\n  const originalStatus = status.reblog || status\n  let accounts = [originalStatus.account].concat(originalStatus.mentions || [])\n    .filter(account => account.id !== currentVerifyCredentials.id)\n  // Pleroma includes account in mentions as well, so make uniq\n  accounts = uniqBy(accounts, _ => _.id)\n  if (!store.getComposeData(statusId, 'text') && accounts.length) {\n    store.setComposeData(statusId, {\n      text: accounts.map(account => `@${account.acct} `).join('')\n    })\n  }\n}\n\nexport async function postStatus (realm, text, inReplyToId, mediaIds,\n  sensitive, spoilerText, visibility,\n  mediaDescriptions, inReplyToUuid, poll, mediaFocalPoints, contentType, quoteId, localOnly, editId) {\n  const { currentInstance, accessToken, online } = store.get()\n\n  if (!online) {\n    /* no await */ toast.say(\"You cannot post while offline\")\n    return\n  }\n\n  text = text || ''\n\n  const mediaMetadata = (mediaIds || []).map((mediaId, idx) => {\n    return {\n      description: mediaDescriptions && mediaDescriptions[idx],\n      focalPoint: mediaFocalPoints && mediaFocalPoints[idx]\n    }\n  })\n\n  store.set({ postingStatus: true })\n  try {\n    await Promise.all(mediaMetadata.map(async ({ description, focalPoint }, i) => {\n      description = description || ''\n      focalPoint = focalPoint || [0, 0]\n      focalPoint[0] = focalPoint[0] || 0\n      focalPoint[1] = focalPoint[1] || 0\n      if (description || focalPoint[0] || focalPoint[1]) {\n        return putMediaMetadata(currentInstance, accessToken, mediaIds[i], description, focalPoint)\n      }\n    }))\n    if (editId) {\n      prepareToRehydrate()\n      const status = await putStatusToServer(currentInstance, accessToken, editId, text,\n        inReplyToId, mediaIds, sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly)\n      await database.insertStatus(currentInstance, status)\n      await rehydrateStatusOrNotification({ status })\n      emit('statusUpdated', status)\n      emit('postedStatus', realm, inReplyToUuid)\n    } else {\n      const status = await postStatusToServer(currentInstance, accessToken, text,\n        inReplyToId, mediaIds, sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly)\n      addStatusOrNotification(currentInstance, 'home', status)\n      emit('postedStatus', realm, inReplyToUuid)\n    }\n    store.clearComposeData(realm)\n    scheduleIdleTask(() => (mediaIds || []).forEach(mediaId => database.deleteCachedMediaFile(mediaId))) // clean up media cache\n  } catch (e) {\n    console.error(e)\n    /* no await */ toast.say(formatIntl([\"Unable to post: \",[\"error\"]], { error: (e.message || '') }))\n  } finally {\n    store.set({ postingStatus: false })\n  }\n}\n\nexport function setReplySpoiler (realm, spoiler) {\n  const contentWarning = store.getComposeData(realm, 'contentWarning')\n  const contentWarningShown = store.getComposeData(realm, 'contentWarningShown')\n  if (typeof contentWarningShown !== 'undefined' || contentWarning) {\n    return // user has already interacted with the CW\n  }\n  store.setComposeData(realm, {\n    contentWarning: spoiler,\n    contentWarningShown: true\n  })\n}\n\nconst PRIVACY_LEVEL = {\n  direct: 1,\n  private: 2,\n  unlisted: 3,\n  public: 4\n}\n\nexport function setReplyVisibility (realm, replyVisibility) {\n  // return the most private between the user's preferred default privacy\n  // and the privacy of the status they're replying to\n  const postPrivacy = store.getComposeData(realm, 'postPrivacy')\n  if (typeof postPrivacy !== 'undefined') {\n    return // user has already set the postPrivacy\n  }\n  const { currentVerifyCredentials } = store.get()\n  const defaultVisibility = currentVerifyCredentials.source.privacy\n  const visibility = PRIVACY_LEVEL[replyVisibility] < PRIVACY_LEVEL[defaultVisibility]\n    ? replyVisibility\n    : defaultVisibility\n  store.setComposeData(realm, { postPrivacy: visibility })\n}\n","{#if realm === 'home'}\n  <h2 class=\"sr-only\">Compose post</h2>\n{/if}\n<ComposeFileDrop {realm} >\n  <div class=\"{computedClassName} {hideAndFadeIn}\">\n    <ComposeAuthor {realm} {dialogId} />\n    {#if editId}\n      <div class=\"compose-edit-wrapper\"\n           transition:slide=\"{duration: 333}\">\n        <div class=\"compose-edit-toolbar\">\n          <div class=\"compose-edit-toolbar-label\">\n            Editing <a href={\"/statuses/\" + editId}>a post</a>\n          </div>\n          <IconButton\n            label=\"Don't edit\"\n            href=\"#fa-times\"\n            on:click=\"onDontEditClick()\"\n          />\n        </div>\n      </div>\n    {/if}\n    {#if inReplyToId}\n      <div class=\"compose-in-reply-to-wrapper\"\n           transition:slide=\"{duration: 333}\">\n        <div class=\"compose-in-reply-to-toolbar\">\n          <div class=\"compose-in-reply-to-toolbar-label\">\n            Replying to <a href={\"/statuses/\" + inReplyToId}>a post{#if inReplyToHandle}&nbsp;by {inReplyToHandle}{/if}</a>\n          </div>\n          {#if editId}\n            <div style=\"height:36px\"></div>\n          {:else}\n            <IconButton\n              label=\"Don't reply\"\n              href=\"#fa-times\"\n              on:click=\"onDontReplyClick()\"\n            />\n          {/if}\n        </div>\n      </div>\n    {/if}\n    {#if quoteId}\n      <div class=\"compose-quote-wrapper\"\n           transition:slide=\"{duration: 333}\">\n        <div class=\"compose-quote-toolbar\">\n          <div class=\"compose-quote-toolbar-label\">\n            Quoting <a href={\"/statuses/\" + quoteId}>a post{#if quoteHandle}&nbsp;by {quoteHandle}{/if}</a>\n          </div>\n          <IconButton\n            label=\"Don't quote\"\n            href=\"#fa-times\"\n            on:click=\"onDontQuoteClick()\"\n          />\n        </div>\n      </div>\n    {/if}\n    {#if contentWarningShown}\n      <div class=\"compose-content-warning-wrapper\"\n           transition:slide=\"{duration: 333}\">\n        <ComposeContentWarning {realm} {contentWarning} />\n      </div>\n    {/if}\n    <ComposeInput {realm} {text} {autoFocus} on:postAction=\"doPostStatus()\" />\n    <ComposeLengthGauge {length} {overLimit} />\n    <ComposeAutosuggest {realm} {text} {dialogId} />\n    {#if poll && poll.options && poll.options.length}\n      <div class=\"compose-poll-wrapper\"\n           transition:slide=\"{duration: 333}\">\n        <ComposePoll {realm} {poll} />\n      </div>\n    {/if}\n    <ComposeToolbar {realm} {postPrivacy} {media} {contentWarningShown} {text} {poll} {contentType} {editId} {length} {overLimit} {localOnly} />\n    <ComposeMedia {realm} {media} />\n    {#if showSensitive}\n    <ComposeMediaSensitive {realm} {media} {sensitive} {contentWarning} {contentWarningShown} />\n    {/if}\n  </div>\n</ComposeFileDrop>\n<ComposeStickyButton {showSticky}\n                     {overLimit}\n                     {hideAndFadeIn}\n                     {editId}\n                     on:postAction=\"doPostStatus()\" />\n{#if !hideBottomBorder}\n  <div class=\"compose-box-border-bottom {hideAndFadeIn}\"></div>\n{/if}\n\n<style>\n  .compose-box {\n    border-radius: 4px;\n    padding: 20px 20px 0 20px;\n    display: grid;\n    align-items: flex-start;\n    grid-template-areas:\n      \"avatar name        handle      handle\"\n      \"avatar edit        edit        edit\"\n      \"avatar inReplyTo   inReplyTo   inReplyTo\"\n      \"avatar quote       quote       quote\"\n      \"avatar cw          cw          cw\"\n      \"avatar input       input       input\"\n      \"avatar gauge       gauge       gauge\"\n      \"avatar autosuggest autosuggest autosuggest\"\n      \"avatar poll        poll        poll\"\n      \"avatar toolbar     toolbar     toolbar\"\n      \"avatar media       media       media\"\n      \"avatar sensitive   sensitive   sensitive\";\n    grid-template-columns: min-content minmax(0, max-content) 1fr 1fr;\n    position: relative;\n  }\n\n  .compose-box.direct-reply {\n    background-color: var(--status-direct-background);\n  }\n\n  :global(.compose-box-fade-in) {\n    transition: opacity 0.2s linear; /* main page reveal */\n  }\n\n  .compose-box-border-bottom {\n    height: 1px;\n    background: var(--main-border);\n    width: 100%;\n  }\n\n  .compose-content-warning-wrapper {\n    grid-area: cw;\n  }\n\n  .compose-in-reply-to-wrapper {\n    grid-area: inReplyTo;\n  }\n\n  .compose-quote-wrapper {\n    grid-area: quote;\n  }\n\n  .compose-edit-wrapper {\n    grid-area: edit;\n  }\n\n  .compose-poll-wrapper {\n    grid-area: poll;\n  }\n\n\n  .compose-in-reply-to-toolbar, .compose-quote-toolbar, .compose-edit-toolbar {\n    font-size: 1.17em;\n    margin: 10px 0 0 5px;\n    border-radius: 3px;\n    padding: 0.25rem 1rem;\n    padding-right: 1rem;\n    background: var(--toast-bg);\n    color: var(--toast-text);\n    border: 1px solid var(--toast-border);\n    display: flex;\n    align-items: center;\n    padding-right: 0;\n  }\n\n  .compose-in-reply-to-toolbar-label, .compose-quote-toolbar-label, .compose-edit-toolbar-label {\n    flex-grow: 1;\n    word-wrap: break-word;\n    width: 0;\n  }\n\n  @media (max-width: 767px) {\n    .compose-box {\n      padding: 10px 10px 0 10px;\n    }\n\n    .compose-box-realm-dialog {\n      overflow-x: hidden;\n    }\n  }\n\n  @media (max-width: 240px) {\n    .compose-box {\n      padding: 10px 5px 0 5px;\n    }\n  }\n</style>\n<script>\n  import ComposeToolbar from './ComposeToolbar.html'\n  import ComposeLengthGauge from './ComposeLengthGauge.html'\n  import ComposeAuthor from './ComposeAuthor.html'\n  import ComposeInput from './ComposeInput.html'\n  import ComposeStickyButton from './ComposeStickyButton.html'\n  import ComposeMedia from './ComposeMedia.html'\n  import ComposeContentWarning from './ComposeContentWarning.html'\n  import ComposeFileDrop from './ComposeFileDrop.html'\n  import ComposeAutosuggest from './ComposeAutosuggest.html'\n  import ComposePoll from './ComposePoll.html'\n  import ComposeMediaSensitive from './ComposeMediaSensitive.html'\n  import { measureText } from '../../_utils/measureText.js'\n  import { POST_PRIVACY_OPTIONS } from '../../_static/statuses.js'\n  import { store } from '../../_store/store.js'\n  import { slide } from '../../_transitions/slide.js'\n  import { postStatus, insertHandleForReply, setReplySpoiler, setReplyVisibility } from '../../_actions/compose.js'\n  import { classname } from '../../_utils/classname.js'\n  import { POLL_EXPIRY_DEFAULT } from '../../_static/polls.js'\n  import { scheduleIdleTask } from '../../_utils/scheduleIdleTask.js'\n  import IconButton from '../IconButton.html'\n\n  export default {\n    oncreate () {\n      const { realm, replySpoiler, replyVisibility } = this.get()\n      if (realm !== 'home' && realm !== 'dialog') {\n        // if this is a reply, populate the handle immediately\n        /* no await */ insertHandleForReply(realm)\n      }\n\n      if (replySpoiler) {\n        // default spoiler is same as the replied-to status\n        setReplySpoiler(realm, replySpoiler)\n      }\n\n      if (replyVisibility) {\n        // make sure the visibility is consistent with the replied-to status\n        setReplyVisibility(realm, replyVisibility)\n      }\n    },\n    components: {\n      ComposeAuthor,\n      ComposeToolbar,\n      ComposeLengthGauge,\n      ComposeInput,\n      ComposeStickyButton,\n      ComposeMedia,\n      ComposeContentWarning,\n      ComposeFileDrop,\n      ComposeAutosuggest,\n      ComposePoll,\n      ComposeMediaSensitive,\n      IconButton\n    },\n    data: () => ({\n      size: undefined,\n      isReply: false,\n      autoFocus: false,\n      hideBottomBorder: false,\n      hidden: false,\n      dialogId: undefined,\n      aboutToPostStatus: false\n    }),\n    store: () => store,\n    computed: {\n      computedClassName: ({ overLimit, realm, size, postPrivacyKey, isReply }) => (classname(\n        'compose-box',\n        `compose-box-realm-${realm}`,\n        overLimit && 'over-char-limit',\n        isReply && postPrivacyKey === 'direct' && 'direct-reply'\n      )),\n      hideAndFadeIn: ({ hidden }) => (classname(\n        'compose-box-fade-in',\n        hidden && 'hidden'\n      )),\n      showSticky: ({ realm }) => realm === 'home',\n      composeData: ({ $currentComposeData, realm }) => $currentComposeData[realm] || {},\n      localOnly: ({ composeData }) => composeData.localOnly || false,\n      text: ({ composeData }) => composeData.text || '',\n      media: ({ composeData }) => composeData.media || [],\n      poll: ({ composeData }) => composeData.poll,\n      inReplyToId: ({ composeData }) => composeData.inReplyToId,\n      postPrivacy: ({ postPrivacyKey }) => POST_PRIVACY_OPTIONS.find(_ => _.key === postPrivacyKey),\n      defaultPostPrivacyKey: ({ $currentVerifyCredentials }) => (\n        ($currentVerifyCredentials && $currentVerifyCredentials.source.privacy) || 'public'\n      ),\n      postPrivacyKey: ({ composeData, defaultPostPrivacyKey }) => composeData.postPrivacy || defaultPostPrivacyKey,\n      textLength: ({ text }) => measureText(text),\n      contentWarningLength: ({ contentWarning }) => measureText(contentWarning),\n      length: ({ textLength, contentWarningLength, contentWarningShown }) => (\n        textLength + (contentWarningShown ? contentWarningLength : 0)\n      ),\n      overLimit: ({ length, $maxStatusChars }) => length > $maxStatusChars,\n      contentWarningShown: ({ composeData }) => composeData.contentWarningShown,\n      contentWarning: ({ composeData }) => composeData.contentWarning || '',\n      sensitive: ({ composeData }) => !!composeData.sensitive,\n      contentType: ({ composeData }) => composeData.contentType,\n      inReplyToHandle: ({ composeData }) => composeData.inReplyToHandle,\n      quoteId: ({ composeData }) => composeData.quoteId,\n      quoteHandle: ({ composeData }) => composeData.quoteHandle,\n      editId: ({ composeData }) => composeData.editId,\n      showSensitive: ({ $currentSupportedToggles }) => $currentSupportedToggles ? $currentSupportedToggles.sensitive : true\n    },\n    transitions: {\n      slide\n    },\n    methods: {\n      async doPostStatus () {\n        const { aboutToPostStatus } = this.get()\n        const { postingStatus } = this.store.get()\n        if (aboutToPostStatus || postingStatus) { // do nothing if the user rapidly taps the Ctrl-Enter key\n          console.log('ignored post command', { aboutToPostStatus, postingStatus })\n          return\n        }\n        // The reason we add a scheduleIdleTask delay here is because we also use scheduleIdleTask\n        // in ComposeInput.html to debounce the input events. If the user is very fast at typing\n        // at their keyboard and quickly presses Ctrl+Enter or the \"Toot\" button then there could\n        // be a race condition where not all of their status is posted.\n        this.set({ aboutToPostStatus: true })\n        scheduleIdleTask(() => {\n          this.set({ aboutToPostStatus: false })\n          this.doPostStatusAfterDelay()\n        })\n      },\n      doPostStatusAfterDelay () {\n        const {\n          text,\n          media,\n          postPrivacyKey,\n          contentWarning,\n          realm,\n          overLimit,\n          inReplyToUuid, // typical replies, using Pinafore-specific uuid\n          inReplyToId, // delete-and-redraft replies, using standard id\n          quoteId,\n          poll,\n          sensitive,\n          contentType,\n          editId,\n          localOnly\n        } = this.get()\n        const mediaIds = media.map(_ => _.data.id)\n        const mediaDescriptions = media.map(_ => _.description)\n        const mediaFocalPoints = media.map(_ => [_.focusX, _.focusY])\n        const inReplyTo = inReplyToId || ((realm === 'home' || realm === 'dialog') ? null : realm)\n\n        if (overLimit || (!text && !media.length)) {\n          return // do nothing if invalid\n        }\n\n        const hasPoll = poll && poll.options && poll.options.length\n        if (hasPoll) {\n          // validate poll\n          if (poll.options.length < 2 || !poll.options.every(Boolean)) {\n            return\n          }\n        }\n\n        // convert internal poll format to the format Mastodon's REST API uses\n        const pollToPost = hasPoll && {\n          expires_in: (poll.expiry || POLL_EXPIRY_DEFAULT).toString(),\n          multiple: !!poll.multiple,\n          options: poll.options\n        }\n\n        /* no await */ postStatus(realm, text, inReplyTo, mediaIds,\n          sensitive, contentWarning, postPrivacyKey,\n          mediaDescriptions, inReplyToUuid, pollToPost,\n          mediaFocalPoints, contentType, quoteId, localOnly, editId)\n      },\n      onDontReplyClick () {\n        const { realm } = this.get()\n        store.setComposeData(realm, { inReplyToId: null })\n      },\n      onDontQuoteClick () {\n        const { realm } = this.get()\n        store.setComposeData(realm, { quoteId: null })\n      },\n      onDontEditClick () {\n        const { realm } = this.get()\n        store.setComposeData(realm, { editId: null })\n      }\n    }\n  }\n</script>\n","export default function Worker_fn() {\n  return new Worker(__webpack_public_path__ + \"blurhash.ee398501b782c72327f7.blurhash.js\");\n}\n","export const RESOLUTION = 32\n","import BlurhashWorker from '../_workers/blurhash.js'\nimport PromiseWorker from 'promise-worker'\nimport { RESOLUTION } from '../_static/blurhash.js'\nimport { QuickLRU } from '../_thirdparty/quick-lru/quick-lru.js'\n\n// A timeline will typically show 20-30 articles at once in the virtual list. The maximum number\n// of sensitive images per article is 4. 30*4=120, so this is a very conservative number.\n// Blurhash blobs seem to range from ~1.2-2kB, so this cache could grow to about 2kB*150=300kB max.\nconst cache = new QuickLRU({ maxSize: 150 })\n\nlet worker\nlet canvas\nlet canvasContext2D\n\nexport function init () {\n  worker = worker || new PromiseWorker(new BlurhashWorker())\n}\n\nfunction initCanvas () {\n  if (!canvas) {\n    canvas = document.createElement('canvas')\n    canvas.height = RESOLUTION\n    canvas.width = RESOLUTION\n    canvasContext2D = canvas.getContext('2d')\n  }\n}\n\n// canvas is the backup if we can't use OffscreenCanvas\nasync function decodeUsingCanvas (imageData) {\n  initCanvas()\n  canvasContext2D.putImageData(imageData, 0, 0)\n  return await new Promise((resolve, reject) => {\n    const reader = new window.FileReader()\n    reader.addEventListener('error', () => {\n      reject(reader.error)\n    })\n    reader.addEventListener('load', () => {\n      resolve(reader.result)\n    })\n    canvas.toBlob(blob => {\n      reader.readAsDataURL(blob)\n    })\n  })\n}\n\nasync function decodeWithoutCache (blurhash) {\n  init()\n  const { decoded, imageData } = await worker.postMessage(blurhash)\n  if (decoded) {\n    return decoded\n  }\n  return decodeUsingCanvas(imageData)\n}\n\nexport async function decode (blurhash) {\n  let result = cache.get(blurhash)\n  if (!result) {\n    result = await decodeWithoutCache(blurhash)\n    cache.set(blurhash, result)\n  }\n  return result\n}\n","function normalizeHashtag (hashtag) {\n  return (\n    hashtag && hashtag.startsWith('#') ? hashtag.slice(1) : hashtag\n  ).normalize('NFKC')\n}\n\nfunction isNodeLinkHashtag (element) {\n  return (\n    element.tagName === 'A' &&\n    // it may be a <a> starting with a hashtag\n    (element.textContent?.[0] === '#' ||\n      // or a #<a>\n      element.previousSibling?.textContent?.[\n        element.previousSibling.textContent.length - 1\n      ] === '#')\n  )\n}\n\n/**\n * Removes duplicates from an hashtag list, case-insensitive, keeping only the best one\n * \"Best\" here is defined by the one with the more casing difference (ie, the most camel-cased one)\n * @param hashtags The list of hashtags\n * @returns The input hashtags, but with only 1 occurence of each (case-insensitive)\n */\nfunction uniqueHashtagsWithCaseHandling (hashtags) {\n  const groups = hashtags.reduce((obj, tag) => {\n    const normalizedTag = tag.normalize('NFKD').toLowerCase();\n    (obj[normalizedTag] = obj[normalizedTag] || []).push(tag)\n    return obj\n  }, {})\n\n  return Object.values(groups).map((tags) => tags[0])\n}\n\n// Create the collator once, this is much more efficient\nconst collator = new Intl.Collator(undefined, {\n  sensitivity: 'base' // we use this to emulate the ASCII folding done on the server-side, hopefuly more efficiently\n})\n\nfunction localeAwareInclude (collection, value) {\n  const normalizedValue = value.normalize('NFKC')\n\n  return !!collection.find(\n    (item) => collator.compare(item.normalize('NFKC'), normalizedValue) === 0\n  )\n}\n\nexport function computeHashtagBarForStatus (status) {\n  let statusContent = status.content\n\n  const tagNames = status.tags.map((tag) => tag.name)\n\n  // this is returned if we stop the processing early, it does not change what is displayed\n  const defaultResult = {\n    statusContent,\n    hashtagsInBar: []\n  }\n\n  // return early if this status does not have any tags\n  if (tagNames.length === 0) return defaultResult\n\n  const template = document.createElement('template')\n  template.innerHTML = statusContent.trimEnd()\n\n  const normalizedTagNames = tagNames.map((tag) => tag.normalize('NFKC'))\n  const isValidNode = node => {\n    if (!node) {\n      return false\n    }\n    if (isNodeLinkHashtag(node) && node.textContent) {\n      const normalized = normalizeHashtag(node.textContent)\n      if (!localeAwareInclude(normalizedTagNames, normalized)) {\n        // stop here, this is not a real hashtag, so consider it as text\n        return false\n      }\n      return normalized\n    } else if (node.nodeType !== 3 || node.nodeValue?.trim()) {\n      // not a space\n      return false\n    } else {\n      // spaces\n      return true\n    }\n  }\n\n  let lastChild = template.content.lastChild\n  if (isValidNode(lastChild)) {\n    const wrap = document.createElement('template')\n    while (lastChild && isValidNode(lastChild)) {\n      const previousSibling = lastChild.previousSibling\n      wrap.appendChild(lastChild)\n      lastChild = previousSibling\n    }\n    if (lastChild && lastChild.tagName === 'BR') {\n      lastChild.remove()\n    }\n    lastChild = wrap\n  }\n\n  if (!lastChild) return defaultResult\n\n  lastChild.remove()\n  if (!lastChild.firstElementChild) {\n    const wrap = document.createElement('template')\n    wrap.appendChild(lastChild)\n    lastChild = wrap\n  }\n  const contentWithoutLastLine = template\n\n  // First, try to parse\n  const contentHashtags = Array.from(\n    contentWithoutLastLine.content.querySelectorAll('a[href]')\n  ).reduce((result, link) => {\n    if (isNodeLinkHashtag(link)) {\n      if (link.textContent) result.push(normalizeHashtag(link.textContent))\n    }\n    return result\n  }, [])\n\n  // Now we parse the last line, and try to see if it only contains hashtags\n  const lastLineHashtags = []\n  // try to see if the last line is only hashtags\n  let onlyHashtags = true\n\n  for (const node of lastChild.childNodes) {\n    const tag = isValidNode(node)\n    if (typeof tag === 'string') {\n      lastLineHashtags.push(tag)\n    } else if (!tag) {\n      onlyHashtags = false\n    }\n  }\n\n  const hashtagsInBar = tagNames.filter((tag) => {\n    const normalizedTag = tag.normalize('NFKC')\n    // the tag does not appear at all in the status content, it is an out-of-band tag\n    return (\n      !localeAwareInclude(contentHashtags, normalizedTag) &&\n      !localeAwareInclude(lastLineHashtags, normalizedTag)\n    )\n  })\n\n  const isOnlyOneLine = contentWithoutLastLine.content.childElementCount === 0\n  const hasMedia = status.media_attachments && status.media_attachments.length > 0\n  const hasSpoiler = !!status.spoiler_text\n\n  if (onlyHashtags && ((hasMedia && !hasSpoiler) || !isOnlyOneLine)) {\n    // if the last line only contains hashtags, and we either:\n    // - have other content in the status\n    // - dont have other content, but a media and no CW. If it has a CW, then we do not remove the content to avoid having an empty content behind the CW button\n    statusContent = contentWithoutLastLine.innerHTML\n    // and add the tags to the bar\n    hashtagsInBar.push(...lastLineHashtags)\n  }\n\n  return {\n    statusContent,\n    hashtagsInBar: uniqueHashtagsWithCaseHandling(hashtagsInBar)\n  }\n}\n","import { get } from '../_utils/lodash-lite.js'\nimport { mark, stop } from '../_utils/marks.js'\nimport {\n  decode as decodeBlurhash,\n  init as initBlurhash\n} from '../_utils/blurhash.js'\nimport { scheduleIdleTask } from '../_utils/scheduleIdleTask.js'\nimport { statusHtmlToPlainText } from '../_utils/statusHtmlToPlainText.js'\nimport { computeHashtagBarForStatus } from '../_utils/hashtagBar.js'\n\nfunction getActualStatus (statusOrNotification) {\n  return (\n    get(statusOrNotification, ['status']) ||\n    get(statusOrNotification, ['notification', 'status'])\n  )\n}\n\nexport function prepareToRehydrate () {\n  // start the blurhash worker a bit early to save time\n  try {\n    initBlurhash()\n  } catch (err) {\n    console.error('could not start blurhash worker', err)\n  }\n}\n\nasync function decodeAllBlurhashes (statusOrNotification) {\n  const status = getActualStatus(statusOrNotification)\n  if (!status) {\n    return\n  }\n  const mediaWithBlurhashes = get(status, ['media_attachments'], [])\n    .concat(get(status, ['reblog', 'media_attachments'], []))\n    .filter(_ => _.blurhash)\n  if (mediaWithBlurhashes.length) {\n    mark(`decodeBlurhash-${status.id}`)\n    await Promise.all(\n      mediaWithBlurhashes.map(async media => {\n        try {\n          media.decodedBlurhash = await decodeBlurhash(media.blurhash)\n          console.log('decoded blurhash for', media)\n        } catch (err) {\n          console.warn('Could not decode blurhash, ignoring', err)\n        }\n      })\n    )\n    stop(`decodeBlurhash-${status.id}`)\n  }\n}\n\nasync function calculatePlainTextContent (statusOrNotification) {\n  const status = getActualStatus(statusOrNotification)\n  if (!status) {\n    return\n  }\n  const originalStatus = status.reblog ? status.reblog : status\n  const content = originalStatus.content || ''\n  const mentions = originalStatus.mentions || []\n  // Calculating the plaintext from the HTML is a non-trivial operation, so we might\n  // as well do it in advance, while blurhash is being decoded on the worker thread.\n  await new Promise(resolve => {\n    scheduleIdleTask(() => {\n      originalStatus.plainTextContent = statusHtmlToPlainText(content, mentions)\n      resolve()\n    })\n  })\n}\n\nexport const rehydrated = Symbol('rehydrated')\n\nfunction markAsRehydrated (statusOrNotification) {\n  const status = getActualStatus(statusOrNotification)\n  if (!status) {\n    return\n  }\n  const originalStatus = status.reblog ? status.reblog : status\n  originalStatus[rehydrated] = true\n}\n\nfunction rehydrateQuote (statusOrNotification) {\n  const status = getActualStatus(statusOrNotification)\n  if (!status) {\n    return\n  }\n  const originalStatus = status.reblog ? status.reblog : status\n  if (originalStatus.quote) {\n    return rehydrateStatusOrNotification({ status: originalStatus.quote })\n  }\n}\n\nfunction setHashtagBar (statusOrNotification) {\n  const status = getActualStatus(statusOrNotification)\n  if (!status) {\n    return\n  }\n  const originalStatus = status.reblog ? status.reblog : status\n  try {\n    const { statusContent, hashtagsInBar } = computeHashtagBarForStatus(originalStatus)\n    originalStatus.content = statusContent\n    originalStatus.hashtagsInBar = hashtagsInBar\n  } catch (e) {\n    console.warn('failed to computeHashtagBarForStatus', originalStatus, e)\n  }\n}\n\n// Do stuff that we need to do when the status or notification is fetched from the database,\n// like calculating the blurhash or calculating the plain text content\nexport async function rehydrateStatusOrNotification (statusOrNotification) {\n  setHashtagBar(statusOrNotification)\n  await Promise.all([\n    decodeAllBlurhashes(statusOrNotification),\n    calculatePlainTextContent(statusOrNotification),\n    rehydrateQuote(statusOrNotification)\n  ])\n  markAsRehydrated(statusOrNotification)\n}\n","import { auth, basename } from './utils.js'\nimport { DEFAULT_TIMEOUT, get, post, put, WRITE_TIMEOUT } from '../_utils/ajax.js'\n\n// post is create, put is edit\nasync function postOrPutStatus (url, accessToken, method, text, inReplyToId, mediaIds,\n  sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly) {\n  const body = {\n    status: text,\n    media_ids: mediaIds,\n    sensitive,\n    spoiler_text: spoilerText,\n    content_type: contentType,\n    quote_id: quoteId,\n    local_only: localOnly,\n    visibility,\n    poll,\n    ...(method === 'post' && {\n      // you can't change these properties when editing\n      in_reply_to_id: inReplyToId,\n      visibility\n    })\n  }\n\n  for (const key of Object.keys(body)) {\n    const value = body[key]\n    // remove any unnecessary fields, except 'status' which must at least be an empty string\n    if (key !== 'status' && key !== 'local_only' && (!value || (Array.isArray(value) && !value.length))) {\n      delete body[key]\n    }\n  }\n\n  const func = method === 'post' ? post : put\n\n  return func(url, body, auth(accessToken), { timeout: WRITE_TIMEOUT })\n}\n\nexport async function postStatus (instanceName, accessToken, text, inReplyToId, mediaIds,\n  sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly) {\n  const url = `${basename(instanceName)}/api/v1/statuses`\n  return postOrPutStatus(url, accessToken, 'post', text, inReplyToId, mediaIds,\n    sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly)\n}\n\nexport async function putStatus (instanceName, accessToken, id, text, inReplyToId, mediaIds,\n  sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly) {\n  const url = `${basename(instanceName)}/api/v1/statuses/${id}`\n  return postOrPutStatus(url, accessToken, 'put', text, inReplyToId, mediaIds,\n    sensitive, spoilerText, visibility, poll, contentType, quoteId, localOnly)\n}\n\nexport async function getStatusContext (instanceName, accessToken, statusId) {\n  const url = `${basename(instanceName)}/api/v1/statuses/${statusId}/context`\n  return get(url, auth(accessToken), { timeout: DEFAULT_TIMEOUT })\n}\n\nexport async function getStatus (instanceName, accessToken, statusId) {\n  const url = `${basename(instanceName)}/api/v1/statuses/${statusId}`\n  return get(url, auth(accessToken), { timeout: DEFAULT_TIMEOUT })\n}\n\nexport async function getStatusSource (instanceName, accessToken, statusId) {\n  const url = `${basename(instanceName)}/api/v1/statuses/${statusId}/source`\n  return get(url, auth(accessToken), { timeout: DEFAULT_TIMEOUT })\n}\n","export const importShowEmojiDialog = () => import(\n  '../creators/showEmojiDialog.js'\n).then(mod => mod.default)\n","// Modified from https://github.com/jackmoore/autosize/blob/113f1b3/src/autosize.js\n// The only change is to remove IE-specific hacks,\n// remove parent overflow checks, make page resizes more performant,\n// add deferredUpdate, and add perf marks.\n\nimport { mark, stop } from '../../_utils/marks.js'\nimport { debounce } from '../../_thirdparty/lodash/timers.js'\nimport { getScrollContainer } from '../../_utils/scrollContainer.js'\nimport { throttleTimer } from '../../_utils/throttleTimer.js'\n\nconst doUpdate = process.browser && throttleTimer(requestAnimationFrame)\n\nconst map = new Map()\n\nfunction assign (ta) {\n  if (!ta || !ta.nodeName || ta.nodeName !== 'TEXTAREA' || map.has(ta)) {\n    return\n  }\n\n  // TODO: hack - grab our scroll container so we can maintain the scrollTop\n  const container = getScrollContainer()\n  let heightOffset = null\n\n  function init () {\n    const style = window.getComputedStyle(ta, null)\n\n    if (style.boxSizing === 'content-box') {\n      heightOffset = -(parseFloat(style.paddingTop) + parseFloat(style.paddingBottom))\n    } else {\n      heightOffset = parseFloat(style.borderTopWidth) + parseFloat(style.borderBottomWidth)\n    }\n\n    update()\n  }\n\n  function resize () {\n    mark('autosize:resize()')\n    _resize()\n    stop('autosize:resize()')\n  }\n\n  function _resize () {\n    const originalHeight = ta.style.height\n    const scrollTop = container.scrollTop\n\n    ta.style.height = '' // this may change the scrollTop in Firefox\n\n    const endHeight = ta.scrollHeight + heightOffset\n\n    if (ta.scrollHeight === 0) {\n      // If the scrollHeight is 0, then the element probably has display:none or is detached from the DOM.\n      ta.style.height = originalHeight\n    } else {\n      ta.style.height = `${endHeight}px`\n      container.scrollTop = scrollTop // Firefox jiggles if we don't reset the scrollTop of the container\n    }\n  }\n\n  const deferredUpdate = () => doUpdate(update)\n\n  function update () {\n    mark('autosize:update()')\n    _update()\n    stop('autosize:update()')\n  }\n\n  function _update () {\n    resize()\n  }\n\n  const pageResize = debounce(() => requestAnimationFrame(update), 1000)\n\n  const destroy = () => {\n    window.removeEventListener('resize', pageResize, false)\n    ta.removeEventListener('input', deferredUpdate, false)\n\n    map.delete(ta)\n  }\n\n  window.addEventListener('resize', pageResize, false)\n  ta.addEventListener('input', deferredUpdate, false)\n\n  map.set(ta, {\n    destroy,\n    update\n  })\n\n  init()\n}\n\nfunction destroy (ta) {\n  const methods = map.get(ta)\n  if (methods) {\n    methods.destroy()\n  }\n}\n\nfunction update (ta) {\n  const methods = map.get(ta)\n  if (methods) {\n    methods.update()\n  }\n}\n\nconst autosize = (el, options) => {\n  if (el) {\n    Array.prototype.forEach.call(el.length ? el : [el], x => assign(x, options))\n  }\n  return el\n}\nautosize.destroy = el => {\n  if (el) {\n    Array.prototype.forEach.call(el.length ? el : [el], destroy)\n  }\n  return el\n}\nautosize.update = el => {\n  if (el) {\n    Array.prototype.forEach.call(el.length ? el : [el], update)\n  }\n  return el\n}\n\nexport { autosize }\n","import { thunk } from './thunk.js'\n\nexport const urlRegex = thunk(() => {\n  // this is provided at build time to avoid having a lot of runtime code just to build\n  // a static regex\n  return process.env.URL_REGEX\n})\n","/* eslint-disable */\nimport { thunk } from './thunk.js'\n\nexport const handleRegex = thunk(() => /(^|[^\\/\\w])@(([a-z0-9_]+)@[a-z0-9\\.\\-]+[a-z0-9]+)/ig)\n/* eslint-enable */\n","// via https://github.com/tootsuite/mastodon/blob/5d5c0f4/app/javascript/mastodon/features/compose/util/counter.js\n\nimport { urlRegex } from './urlRegex.js'\nimport { handleRegex } from './handleRegex.js'\nimport { mark, stop } from './marks.js'\nimport { length } from 'stringz'\n\nconst urlPlaceholder = 'xxxxxxxxxxxxxxxxxxxxxxx'\n\nexport function measureText (inputText) {\n  if (!inputText) {\n    return 0\n  }\n  mark('measureText()')\n  const normalizedText = inputText\n    .replace(urlRegex(), urlPlaceholder)\n    .replace(handleRegex(), '$1@$3')\n  const len = length(normalizedText)\n  stop('measureText()')\n  return len\n}\n","// modeled after https://github.com/andrewiggins/afterframe\n// see also https://github.com/WICG/requestPostAnimationFrame\nconst channel = process.browser && new MessageChannel()\nconst callbacks = []\n\nif (process.browser) {\n  channel.port1.onmessage = onMessage\n}\n\nfunction runCallback (callback) {\n  try {\n    callback()\n  } catch (e) {\n    console.error(e)\n  }\n}\n\nfunction onMessage () {\n  for (const callback of callbacks) {\n    runCallback(callback)\n  }\n  callbacks.length = 0\n}\n\nfunction postMessage () {\n  channel.port2.postMessage(undefined)\n}\n\nexport const requestPostAnimationFrame = callback => {\n  if (callbacks.push(callback) === 1) {\n    requestAnimationFrame(postMessage)\n  }\n}\n","import { mark, stop } from './marks.js'\n\nconst domParser = process.browser && new DOMParser()\n\n// mentions like \"@foo\" have to be expanded to \"@foo@example.com\"\nfunction massageMentions (doc, mentions) {\n  const anchors = doc.querySelectorAll('a.mention')\n  for (let i = 0; i < anchors.length; i++) {\n    const anchor = anchors[i]\n    const href = anchor.getAttribute('href')\n    const mention = mentions.find(mention => mention.url === href)\n    if (mention) {\n      anchor.innerText = `@${mention.acct}`\n    }\n  }\n}\n\n// paragraphs should be separated by double newlines\n// single <br/>s should become single newlines\nfunction innerTextRetainingNewlines (doc) {\n  let res = ''\n  const paragraphs = doc.querySelectorAll('p')\n  for (let i = 0; i < paragraphs.length; i++) {\n    const paragraph = paragraphs[i]\n    const brs = paragraph.querySelectorAll('br')\n    for (let j = 0; j < brs.length; j++) {\n      const br = brs[j]\n      br.parentNode.replaceChild(doc.createTextNode('\\n'), br)\n    }\n    res += (i > 0 ? '\\n\\n' : '') + paragraph.textContent\n  }\n  return res\n}\n\nexport function statusHtmlToPlainText (html, mentions) {\n  if (!html) {\n    return ''\n  }\n  mark('statusHtmlToPlainText')\n  const doc = domParser.parseFromString(html, 'text/html')\n  massageMentions(doc, mentions)\n  const res = innerTextRetainingNewlines(doc)\n  stop('statusHtmlToPlainText')\n  return res\n}\n","// Sometimes we want to queue multiple requestAnimationFrames but only run the last one.\n// It's tedious to do this using cancelAnimationFrame, so this is a utility to throttle\n// a timer such that it only runs the last callback when it fires.\n\nexport const throttleTimer = timer => {\n  let queuedCallback\n\n  const flush = () => {\n    const callback = queuedCallback\n    queuedCallback = null\n    callback()\n  }\n\n  return callback => {\n    if (!queuedCallback) {\n      timer(flush)\n    }\n    queuedCallback = callback\n  }\n}\n"],"names":["updateDisplayedLength","requestAnimationFrame","observe","lengthAsFraction","this","get","set","lengthAsFractionDeferred","s","shouldAnimate","init","style","computedStyle","computedClass","length","max","int","Math","round","min","overLimit","$reduceMotion","lengthToDisplay","lengthToDisplayDeferred","lengthVerbosity","store","$maxStatusChars","onEmojiClick","realm","currentInstance","showEmojiDialog","Promise","all","importShowEmojiDialog","onMediaClick","refs","input","click","onFileChange","e","files","target","file","onPostPrivacyClick","then","mod","default","onContentTypeClick","onContentWarningClick","shown","getComposeData","contentWarning","newShown","setComposeData","contentWarningShown","sensitive","toggleContentWarningShown","onPollClick","poll","options","disablePoll","enablePoll","mediaAccept","$uploadingMedia","media","$maxStatusMediaAttachments","postPrivacyLabel","actualPostPrivacy","icon","editId","contentTypeIcon","event","postPrivacy","localOnly","label","formatIntl","contentType","onClick","dialogId","href","preventDefault","stopPropagation","setTimeout","verifyCredentials","acct","avatarSize","loaded","$currentVerifyCredentials","display_name","avatar","avatar_static","id","$isVeryTinyMobileSize","emojiMapper","emoji","unicode","shortcodes","hashtagMapper","hashtag","name","accountMapper","account","async","insertTextAtPosition","text","startIndex","endIndex","oldText","newText","substring","setForAutosuggest","autosuggestSearchResults","clickSelectedItem","resultMapper","composeSelectionStart","autosuggestSearchText","autosuggestSelected","result","selectAutosuggestItem","item","currentComposeRealm","insertUsername","insertEmojiAtPosition","insertHashtag","isWebKit","webkitIndexedDB","updateComposeTextInStore","throttleTimer","scheduleIdleTask","setupSyncFromStore","textarea","firstTime","rawText","newSelectionStart","selectionStart","selectionEnd","autosize","update","autoFocus","setAttribute","focus","preventScroll","setupSyncToStore","save","setupAutosize","requestPostAnimationFrame","teardownAutosize","destroy","onBlur","setForCurrentAutosuggest","composeFocused","onFocus","onSelectionChange","onKeydown","keyCode","ctrlPressed","getModifierState","clickSelectedAutosuggestion","fire","incrementAutosuggestSelected","clearAutosuggestions","autosuggestShown","autosuggestType","autosuggestSelecting","clickSelectedAutosuggestionUsername","clickSelectedAutosuggestionHashtag","clickSelectedAutosuggestionEmoji","clickAutosuggestedItem","increment","setupResize","on","setCursorIfNecessary","value","autosuggestShownForThisInput","activeDescendant","$autosuggestData_composeFocused","$currentInstance","$autosuggestShown","$autosuggestData_autosuggestSelected","undefined","$postingStatus","sticky","disabled","onClickButton","showDialog","importShowComposeDialog","setupIntersectionObservers","showSticky","sentinel","__stickyObserver","IntersectionObserver","entries","onObserve","timelineInitialized","__oneShotObserver","disconnect","isIntersecting","teardownIntersectionObservers","$timelineInitialized","hideAndFadeIn","classname","updateMediaInStore","resizeTextarea","index","focusX","focusY","description","onDeleteMedia","onEdit","type","objectPosition","previewSrc","uuid","shortName","mediaItem","data","preview_url","coordsToPercent","updateContentWarningInStore","onFileDrop","bind","fileDrop","addEventListener","removeEventListener","onFileDRop","items","$omitEmojiInDisplayNames","map","i","selectedIndex","searchResults","selected","concat","join","displayName","username","emojis","removeEmoji","createAutosuggestAccessibleLabel","_","url","ariaLabels","once","eventName","callback","listener","eventValue","cancel","_promiseChain","resolve","shouldBeShown","race","top","left","$autosuggestData_composeSelectionStart","$autosuggestData_autosuggestSearchResults","$autosuggestData_autosuggestType","updatePosition","setup","_element","document","getElementById","createElement","querySelector","body","appendChild","calculateLeftAndTop","_autosuggest","onResize","doResize","anchor","bottom","getBoundingClientRect","scrollTop","setupDone","remove","POLL_EXPIRY_OPTIONS","POLL_EXPIRY_DEFAULT","flushPollOptionsToDom","onChange","element","onMultipleChange","multiple","checked","onDeleteClick","splice","onAddClick","push","onExpiryChange","expiry","parseInt","pollExpiryDefaultValue","createLabel","pollExpiryOptions","rawChecked","slide","node","ref","reduceMotion","delay","duration","easing","css","PRIVACY_LEVEL","direct","private","unlisted","public","doPostStatus","aboutToPostStatus","postingStatus","doPostStatusAfterDelay","postPrivacyKey","inReplyToUuid","inReplyToId","quoteId","mediaIds","mediaDescriptions","mediaFocalPoints","inReplyTo","hasPoll","every","Boolean","spoilerText","visibility","accessToken","online","toast","say","mediaMetadata","mediaId","idx","focalPoint","status","database","insertStatus","rehydrateStatusOrNotification","addStatusOrNotification","clearComposeData","forEach","deleteCachedMediaFile","console","error","message","postStatus","expires_in","toString","onDontReplyClick","onDontQuoteClick","onDontEditClick","replySpoiler","replyVisibility","statusId","getStatus","currentVerifyCredentials","originalStatus","reblog","accounts","mentions","filter","insertHandleForReply","spoiler","setReplySpoiler","defaultVisibility","source","privacy","setReplyVisibility","inReplyToHandle","quoteHandle","size","isReply","hideBottomBorder","hidden","computedClassName","showSensitive","$currentComposeData","composeData","measureText","textLength","contentWarningLength","defaultPostPrivacyKey","find","key","$currentSupportedToggles","Worker_fn","Worker","RESOLUTION","cache","maxSize","worker","canvas","canvasContext2D","decodeUsingCanvas","imageData","height","width","getContext","putImageData","reject","reader","window","FileReader","toBlob","blob","readAsDataURL","decode","blurhash","decoded","postMessage","decodeWithoutCache","normalizeHashtag","startsWith","slice","normalize","isNodeLinkHashtag","tagName","textContent","previousSibling","uniqueHashtagsWithCaseHandling","hashtags","groups","reduce","obj","tag","normalizedTag","toLowerCase","Object","values","tags","collator","Intl","Collator","sensitivity","localeAwareInclude","collection","normalizedValue","compare","getActualStatus","statusOrNotification","prepareToRehydrate","err","decodeAllBlurhashes","mediaWithBlurhashes","decodedBlurhash","warn","calculatePlainTextContent","content","plainTextContent","statusHtmlToPlainText","rehydrated","Symbol","rehydrateQuote","quote","setHashtagBar","statusContent","hashtagsInBar","tagNames","defaultResult","template","innerHTML","trimEnd","normalizedTagNames","isValidNode","normalized","nodeType","nodeValue","trim","lastChild","wrap","firstElementChild","contentWithoutLastLine","contentHashtags","Array","from","querySelectorAll","link","lastLineHashtags","onlyHashtags","childNodes","isOnlyOneLine","childElementCount","hasMedia","media_attachments","hasSpoiler","spoiler_text","computeHashtagBarForStatus","markAsRehydrated","postOrPutStatus","method","media_ids","content_type","quote_id","local_only","in_reply_to_id","keys","isArray","timeout","instanceName","putStatus","getStatusContext","getStatusSource","doUpdate","Map","assign","ta","nodeName","has","container","heightOffset","resize","originalHeight","endHeight","scrollHeight","_resize","deferredUpdate","pageResize","delete","getComputedStyle","boxSizing","parseFloat","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","methods","el","prototype","call","x","urlRegex","thunk","handleRegex","urlPlaceholder","inputText","normalizedText","replace","len","channel","MessageChannel","callbacks","runCallback","port2","port1","onmessage","domParser","DOMParser","html","doc","parseFromString","anchors","getAttribute","mention","innerText","massageMentions","res","paragraphs","paragraph","brs","j","br","parentNode","replaceChild","createTextNode","innerTextRetainingNewlines","timer","queuedCallback","flush"],"sourceRoot":""}